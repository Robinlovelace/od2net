import{S as oe,i as re,s as ie,G as ue,e as z,h as T,z as U,l as P,I as $,q as N,J as pe,K as ce,N as de,O as me,t as L,b as M,v as q,w as ge,Q as _e,R as be,T as Y,U as x,m as he,L as we,c as I,f as S,a as O,d as D,o as Le,H as ve,x as X,y as W,g as V,n as v,A as Q,r as ee,u as te,M as ye,_ as ke,V as fe,W as Ce,j as ne,D as Me,E as Be,X as Ee}from"./Legend-fb6fd039.js";import{L as ze,C as Se,O as Ie,_ as Oe,J as De,a as Pe,G as qe}from"./OverpassSelector-d5c4d098.js";import{S as Je,L as Ne}from"./SidebarControls-cac3e760.js";function Te(s){let e,t,l,n,o,u,p;const a=s[16].default,f=ue(a,s,s[15],null);return{c(){e=z("div"),f&&f.c(),T(e,"tabindex",t=s[1]?0:void 0),T(e,"role",l=s[1]?"button":void 0),U(e,"z-index",s[2])},m(i,g){P(i,e,g),f&&f.m(e,null),o=!0,u||(p=[$(s[6].call(null,e)),$(n=je.call(null,e,s[0])),N(e,"click",s[17]),N(e,"dblclick",s[18]),N(e,"contextmenu",s[19]),N(e,"mouseenter",s[20]),N(e,"mouseleave",s[21]),N(e,"mousemove",s[22]),N(e,"keydown",s[7])],u=!0)},p(i,[g]){f&&f.p&&(!o||g&32768)&&pe(f,a,i,i[15],o?de(a,i[15],g,null):ce(i[15]),null),(!o||g&2&&t!==(t=i[1]?0:void 0))&&T(e,"tabindex",t),(!o||g&2&&l!==(l=i[1]?"button":void 0))&&T(e,"role",l),n&&me(n.update)&&g&1&&n.update.call(null,i[0]),g&4&&U(e,"z-index",i[2])},i(i){o||(L(f,i),o=!0)},o(i){M(f,i),o=!1},d(i){i&&q(e),f&&f.d(i),u=!1,ge(p)}}}function je(s,e){const t=s.className;function l(n){n?s.className=`${t} ${n}`:s.className=t}return l(e),{update:l}}function Ae(s,e,t){let l,n,o,{$$slots:u={},$$scope:p}=e,{lngLat:a}=e,{class:f=void 0}=e,{interactive:i=!0}=e,{asButton:g=!1}=e,{draggable:y=!1}=e,{feature:h=null}=e,{offset:B=void 0}=e,{zIndex:_=void 0}=e;const k=_e(),{map:C,layerEvent:J,self:j}=be();Y(s,C,r=>t(24,o=r)),Y(s,J,r=>t(23,l=r)),Y(s,j,r=>t(14,n=r));function Z(r){x(j,n=new he.Marker({element:r,draggable:y,offset:B}).setLngLat(a).addTo(o),n);const F=()=>c("dragstart"),H=()=>{A(),c("drag")},K=()=>{A(),c("dragend")};return y&&(n.on("dragstart",F),n.on("drag",H),n.on("dragend",K)),{destroy(){y&&(n==null||n.off("dragstart",F),n==null||n.off("drag",H),n==null||n.off("dragend",K)),n==null||n.remove()}}}function A(){let r=n==null?void 0:n.getLngLat();r&&(Array.isArray(a)?t(9,a=[r.lng,r.lat]):a&&"lon"in a?t(9,a={lon:r.lng,lat:r.lat}):t(9,a=r))}function w(r){r.key===" "&&(r.preventDefault(),r.stopPropagation(),c("click"))}function c(r){if(!i)return;let F=n==null?void 0:n.getLngLat();if(!F)return;const H=[F.lng,F.lat];let K={map:o,marker:n,lngLat:H,features:[{type:"Feature",properties:(h==null?void 0:h.properties)??{},geometry:{type:"Point",coordinates:H}}]};x(J,l={...K,layerType:"marker",type:r},l),k(r,K)}const b=()=>c("click"),d=()=>c("dblclick"),E=()=>c("contextmenu"),R=r=>{c("mouseenter")},m=()=>{c("mouseleave")},G=()=>c("mousemove");return s.$$set=r=>{"lngLat"in r&&t(9,a=r.lngLat),"class"in r&&t(0,f=r.class),"interactive"in r&&t(10,i=r.interactive),"asButton"in r&&t(1,g=r.asButton),"draggable"in r&&t(11,y=r.draggable),"feature"in r&&t(12,h=r.feature),"offset"in r&&t(13,B=r.offset),"zIndex"in r&&t(2,_=r.zIndex),"$$scope"in r&&t(15,p=r.$$scope)},s.$$.update=()=>{s.$$.dirty&16896&&(n==null||n.setLngLat(a)),s.$$.dirty&24576&&(n==null||n.setOffset(B??[0,0]))},[f,g,_,C,J,j,Z,w,c,a,i,y,h,B,n,p,u,b,d,E,R,m,G]}class Re extends oe{constructor(e){super(),re(this,e,Ae,Te,ie,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2})}}const Fe=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function se(s){let e,t;return{c(){e=z("p"),t=V(s[10])},m(l,n){P(l,e,n),v(e,t)},p(l,n){n&1024&&Ce(t,l[10])},d(l){l&&q(e)}}}function ae(s){let e,t,l,n,o,u,p,a,f,i,g,y;function h(_){s[21](_)}let B={};return s[2]!==void 0&&(B.cost=s[2]),a=new Pe({props:B}),X.push(()=>W(a,"cost",h)),{c(){e=z("div"),t=z("label"),l=V("Max requests (limit for faster updates):"),n=z("br"),o=S(),u=z("input"),p=S(),I(a.$$.fragment),T(u,"type","number"),T(u,"min",1)},m(_,k){P(_,e,k),v(e,t),v(t,l),v(t,n),v(t,o),v(t,u),ne(u,s[1]),P(_,p,k),O(a,_,k),i=!0,g||(y=N(u,"input",s[20]),g=!0)},p(_,k){k&2&&fe(u.value)!==_[1]&&ne(u,_[1]);const C={};!f&&k&4&&(f=!0,C.cost=_[2],Q(()=>f=!1)),a.$set(C)},i(_){i||(L(a.$$.fragment,_),i=!0)},o(_){M(a.$$.fragment,_),i=!1},d(_){_&&(q(e),q(p)),D(a,_),g=!1,y()}}}function le(s){let e,t,l,n,o;function u(a){s[22](a)}let p={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(p.controls=s[8]),l=new Je({props:p}),X.push(()=>W(l,"controls",u)),{c(){e=z("hr"),t=S(),I(l.$$.fragment)},m(a,f){P(a,e,f),P(a,t,f),O(l,a,f),o=!0},p(a,f){const i={};f&64&&(i.outputMetadata=a[6].metadata),f&8&&(i.map=a[3]),!n&&f&256&&(n=!0,i.controls=a[8],Q(()=>n=!1)),l.$set(i)},i(a){o||(L(l.$$.fragment,a),o=!0)},o(a){M(l.$$.fragment,a),o=!1},d(a){a&&(q(e),q(t)),D(l,a)}}}function Xe(s){let e,t,l,n,o,u,p,a,f,i,g,y,h,B,_,k,C,J,j;t=new ve({props:{app:"interactive"}});function Z(d){s[17](d)}let A={};s[0]!==void 0&&(A.example=s[0]),i=new Se({props:A}),X.push(()=>W(i,"example",Z)),h=new Ie({props:{map:s[3]}}),h.$on("gotXml",s[13]),h.$on("loading",s[18]),h.$on("error",s[19]);let w=s[10]&&se(s),c=s[4]&&ae(s),b=s[6].metadata&&le(s);return{c(){e=z("div"),I(t.$$.fragment),l=S(),n=z("label"),o=V("Open an "),u=z("i"),u.textContent=".osm.pbf",p=V(` file
      `),a=z("input"),f=S(),I(i.$$.fragment),y=S(),I(h.$$.fragment),B=S(),w&&w.c(),_=S(),c&&c.c(),k=S(),b&&b.c(),T(a,"type","file"),T(e,"slot","left")},m(d,E){P(d,e,E),O(t,e,null),v(e,l),v(e,n),v(n,o),v(n,u),v(n,p),v(n,a),s[16](a),v(e,f),O(i,e,null),v(e,y),O(h,e,null),v(e,B),w&&w.m(e,null),v(e,_),c&&c.m(e,null),v(e,k),b&&b.m(e,null),C=!0,J||(j=N(a,"change",s[11]),J=!0)},p(d,E){const R={};!g&&E&1&&(g=!0,R.example=d[0],Q(()=>g=!1)),i.$set(R);const m={};E&8&&(m.map=d[3]),h.$set(m),d[10]?w?w.p(d,E):(w=se(d),w.c(),w.m(e,_)):w&&(w.d(1),w=null),d[4]?c?(c.p(d,E),E&16&&L(c,1)):(c=ae(d),c.c(),L(c,1),c.m(e,k)):c&&(ee(),M(c,1,1,()=>{c=null}),te()),d[6].metadata?b?(b.p(d,E),E&64&&L(b,1)):(b=le(d),b.c(),L(b,1),b.m(e,null)):b&&(ee(),M(b,1,1,()=>{b=null}),te())},i(d){C||(L(t.$$.fragment,d),L(i.$$.fragment,d),L(h.$$.fragment,d),L(c),L(b),C=!0)},o(d){M(t.$$.fragment,d),M(i.$$.fragment,d),M(h.$$.fragment,d),M(c),M(b),C=!1},d(d){d&&q(e),D(t),s[16](null),D(i),D(h),w&&w.d(),c&&c.d(),b&&b.d(),J=!1,j()}}}function Ze(s){let e,t;return{c(){e=new Ee(!1),t=Me(),e.a=t},m(l,n){e.m(Fe,l,n),P(l,t,n)},p:Be,d(l){l&&(q(t),e.d())}}}function Ge(s){let e,t;return e=new Ne({props:{controls:s[8]}}),{c(){I(e.$$.fragment)},m(l,n){O(e,l,n),t=!0},p(l,n){const o={};n&256&&(o.controls=l[8]),e.$set(o)},i(l){t||(L(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){D(e,l)}}}function He(s){let e,t,l,n,o;function u(a){s[14](a)}let p={draggable:!0,$$slots:{default:[Ze]},$$scope:{ctx:s}};return s[5]!==void 0&&(p.lngLat=s[5]),e=new Re({props:p}),X.push(()=>W(e,"lngLat",u)),e.$on("dragend",s[12]),n=new qe({props:{data:s[6],$$slots:{default:[Ge]},$$scope:{ctx:s}}}),{c(){I(e.$$.fragment),l=S(),I(n.$$.fragment)},m(a,f){O(e,a,f),P(a,l,f),O(n,a,f),o=!0},p(a,f){const i={};f&33554432&&(i.$$scope={dirty:f,ctx:a}),!t&&f&32&&(t=!0,i.lngLat=a[5],Q(()=>t=!1)),e.$set(i);const g={};f&64&&(g.data=a[6]),f&33554688&&(g.$$scope={dirty:f,ctx:a}),n.$set(g)},i(a){o||(L(e.$$.fragment,a),L(n.$$.fragment,a),o=!0)},o(a){M(e.$$.fragment,a),M(n.$$.fragment,a),o=!1},d(a){a&&q(l),D(e,a),D(n,a)}}}function Ke(s){let e,t,l,n;function o(p){s[15](p)}let u={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[He]},$$scope:{ctx:s}};return s[3]!==void 0&&(u.map=s[3]),t=new ye({props:u}),X.push(()=>W(t,"map",o)),{c(){e=z("div"),I(t.$$.fragment),T(e,"slot","main"),U(e,"position","relative"),U(e,"width","100%"),U(e,"height","100vh")},m(p,a){P(p,e,a),O(t,e,null),n=!0},p(p,a){const f={};a&33554784&&(f.$$scope={dirty:a,ctx:p}),!l&&a&8&&(l=!0,f.map=p[3],Q(()=>l=!1)),t.$set(f)},i(p){n||(L(t.$$.fragment,p),n=!0)},o(p){M(t.$$.fragment,p),n=!1},d(p){p&&q(e),D(t)}}}function Ue(s){let e,t,l,n;return e=new we({props:{$$slots:{main:[Ke],left:[Xe]},$$scope:{ctx:s}}}),l=new ze({props:{loading:s[7]}}),{c(){I(e.$$.fragment),t=S(),I(l.$$.fragment)},m(o,u){O(e,o,u),P(o,t,u),O(l,o,u),n=!0},p(o,[u]){const p={};u&33556351&&(p.$$scope={dirty:u,ctx:o}),e.$set(p);const a={};u&128&&(a.loading=o[7]),l.$set(a)},i(o){n||(L(e.$$.fragment,o),L(l.$$.fragment,o),n=!0)},o(o){M(e.$$.fragment,o),M(l.$$.fragment,o),n=!1},d(o){o&&q(t),D(e,o),D(l,o)}}}function We(s,e,t){Le(async()=>{await Oe(),await ke()});let l,n,o="",u={lng:0,lat:0},p={type:"FeatureCollection",features:[]},a=!1,f=1e3,i="Distance",g={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function h(m){t(0,o=""),t(7,a=!0),B(!0,await y.files[0].arrayBuffer())}function B(m,G){try{t(4,n=new De(m,new Uint8Array(G))),t(2,i="Distance");let r=n.getBounds();l.fitBounds([[r[0],r[1]],[r[2],r[3]]],{padding:20,animate:!1}),t(5,u.lng=(r[0]+r[2])/2,u),t(5,u.lat=(r[1]+r[3])/2,u),k()}catch(r){window.alert(`Problem importing osm.pbf file: ${r}`)}t(7,a=!1)}async function _(m){if(m!=""){t(7,a=!0);let G=await fetch(`https://assets.od2net.org/pbf_clips/${m}.osm.pbf`);B(!0,await G.arrayBuffer())}}function k(){n&&t(6,p=JSON.parse(n.recalculate({lng:u.lng,lat:u.lat,max_requests:f,cost:i})))}let C="";function J(m){t(10,C="Parsing XML"),B(!1,new TextEncoder().encode(m.detail)),t(10,C="")}function j(m){u=m,t(5,u)}function Z(m){l=m,t(3,l)}function A(m){X[m?"unshift":"push"](()=>{y=m,t(9,y)})}function w(m){o=m,t(0,o)}const c=m=>t(10,C=m.detail),b=m=>t(10,C=m.detail);function d(){f=fe(this.value),t(1,f)}function E(m){i=m,t(2,i)}function R(m){g=m,t(8,g)}return s.$$.update=()=>{s.$$.dirty&1&&_(o),s.$$.dirty&6&&k()},[o,f,i,l,n,u,p,a,g,y,C,h,k,J,j,Z,A,w,c,b,d,E,R]}class Qe extends oe{constructor(e){super(),re(this,e,We,Ue,ie,{})}}new Qe({target:document.getElementById("app")});
