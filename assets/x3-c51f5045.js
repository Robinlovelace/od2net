import{S as te,i as ne,s as le,V as N,e as $,f as O,z as w,l as k,E as I,v,ad as U,g as J,n as g,X as se,L as re,c as y,a as S,t as h,b,d as L,o as oe,H as ie,h as P,j as F,k as ue,p as V,q as W,r as fe,u as ce,w as pe,M as _e,x as ae,y as me,A as de,_ as ge,a3 as $e,ae as X,C as he,af as R,ac as be,a7 as E,a6 as we,a4 as Z,a8 as ke,a9 as ve}from"./Legend-7948e5f4.js";import{_ as ye,J as Se,G as Le}from"./@vite-plugin-wasm-pack@wasm-od2net-acbe675d.js";function K(s,e,n){const t=s.slice();return t[2]=e[n],t}function Q(s,e,n){const t=s.slice();return t[5]=e[n],t}function Y(s){let e,n;return{c(){e=$("span"),n=J(`Â 
    `),w(e,"background",s[5]),w(e,"width","100%"),w(e,"border","1px solid black")},m(t,l){k(t,e,l),g(e,n)},p(t,l){l&1&&w(e,"background",t[5])},d(t){t&&v(e)}}}function x(s){let e,n=s[2]+"",t;return{c(){e=$("span"),t=J(n)},m(l,a){k(l,e,a),g(e,t)},p(l,a){a&2&&n!==(n=l[2]+"")&&se(t,n)},d(l){l&&v(e)}}}function Ce(s){let e,n,t,l=N(s[0]),a=[];for(let o=0;o<l.length;o+=1)a[o]=Y(Q(s,l,o));let u=N(s[1]),i=[];for(let o=0;o<u.length;o+=1)i[o]=x(K(s,u,o));return{c(){e=$("div");for(let o=0;o<a.length;o+=1)a[o].c();n=O(),t=$("div");for(let o=0;o<i.length;o+=1)i[o].c();w(e,"display","flex"),w(t,"display","flex"),w(t,"justify-content","space-between")},m(o,f){k(o,e,f);for(let r=0;r<a.length;r+=1)a[r]&&a[r].m(e,null);k(o,n,f),k(o,t,f);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(t,null)},p(o,[f]){if(f&1){l=N(o[0]);let r;for(r=0;r<l.length;r+=1){const d=Q(o,l,r);a[r]?a[r].p(d,f):(a[r]=Y(d),a[r].c(),a[r].m(e,null))}for(;r<a.length;r+=1)a[r].d(1);a.length=l.length}if(f&2){u=N(o[1]);let r;for(r=0;r<u.length;r+=1){const d=K(o,u,r);i[r]?i[r].p(d,f):(i[r]=x(d),i[r].c(),i[r].m(t,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=u.length}},i:I,o:I,d(o){o&&(v(e),v(n),v(t)),U(a,o),U(i,o)}}}function Te(s,e,n){let{colorScale:t}=e,{limits:l}=e;return s.$$set=a=>{"colorScale"in a&&n(0,t=a.colorScale),"limits"in a&&n(1,l=a.limits)},[t,l]}class je extends te{constructor(e){super(),ne(this,e,Te,Ce,le,{colorScale:0,limits:1})}}function qe(s){let e,n;return e=new je({props:{colorScale:R,limits:B(s[2])}}),{c(){y(e.$$.fragment)},m(t,l){S(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.limits=B(t[2])),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Oe(s){let e,n,t,l;return e=new be({props:{rows:[["LTS 1 - suitable for children",E.lts1],["LTS 2 - low stress",E.lts2],["LTS 3 - medium stress",E.lts3],["LTS 4 - high stress",E.lts4]]}}),{c(){y(e.$$.fragment),n=O(),t=$("p"),t.innerHTML='Note: LTS model from <a href="https://github.com/BikeOttawa/stressmodel/blob/master/stressmodel.js" target="_blank">BikeOttawa</a>'},m(a,u){S(e,a,u),k(a,n,u),k(a,t,u),l=!0},p:I,i(a){l||(h(e.$$.fragment,a),l=!0)},o(a){b(e.$$.fragment,a),l=!1},d(a){a&&(v(n),v(t)),L(e,a)}}}function Me(s){let e,n,t,l,a,u,i,o,f,r,d,C,T,c,p,_,M,H,z;n=new ie({props:{app:"costs"}});const G=[Oe,qe],j=[];function D(m,q){return m[2]=="lts"?0:1}return p=D(s),_=j[p]=G[p](s),{c(){e=$("div"),y(n.$$.fragment),t=O(),l=$("label"),a=J("Open a "),u=$("i"),u.textContent=".bin",i=J(` network file
      `),o=$("input"),f=O(),r=$("select"),d=$("option"),d.textContent="LTS",C=$("option"),C.textContent="Edge cost (relative to length)",T=$("option"),T.textContent="Nearby amenities",c=O(),_.c(),P(o,"type","file"),d.__value="lts",F(d,d.__value),C.__value="cost",F(C,C.__value),T.__value="nearby_amenities",F(T,T.__value),s[2]===void 0&&ue(()=>s[9].call(r)),P(e,"slot","left")},m(m,q){k(m,e,q),S(n,e,null),g(e,t),g(e,l),g(l,a),g(l,u),g(l,i),g(l,o),s[8](o),g(e,f),g(e,r),g(r,d),g(r,C),g(r,T),V(r,s[2],!0),g(e,c),j[p].m(e,null),M=!0,H||(z=[W(o,"change",s[4]),W(r,"change",s[9])],H=!0)},p(m,q){q&4&&V(r,m[2]);let A=p;p=D(m),p===A?j[p].p(m,q):(fe(),b(j[A],1,1,()=>{j[A]=null}),ce(),_=j[p],_?_.p(m,q):(_=j[p]=G[p](m),_.c()),h(_,1),_.m(e,null))},i(m){M||(h(n.$$.fragment,m),h(_),M=!0)},o(m){b(n.$$.fragment,m),b(_),M=!1},d(m){m&&v(e),L(n),s[8](null),j[p].d(),H=!1,pe(z)}}}function Ne(s){let e,n;return e=new ve({props:{properties:s[11][0].properties}}),{c(){y(e.$$.fragment)},m(t,l){S(e,t,l),n=!0},p(t,l){const a={};l&2048&&(a.properties=t[11][0].properties),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ee(s){let e,n;return e=new ke({props:{openOn:"hover",$$slots:{default:[Ne,({features:t})=>({11:t}),({features:t})=>t?2048:0]},$$scope:{ctx:s}}}),{c(){y(e.$$.fragment)},m(t,l){S(e,t,l),n=!0},p(t,l){const a={};l&6144&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Je(s){let e,n;return e=new we({props:{manageHoverState:!0,hoverCursor:"pointer",paint:{"line-width":5,"line-color":s[5](s[2]),"line-opacity":Z(1,.5)},beforeId:"Road labels",$$slots:{default:[Ee]},$$scope:{ctx:s}}}),e.$on("click",s[6]),{c(){y(e.$$.fragment)},m(t,l){S(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.paint={"line-width":5,"line-color":t[5](t[2]),"line-opacity":Z(1,.5)}),l&4096&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Be(s){let e,n;return e=new Le({props:{data:s[1],$$slots:{default:[Je]},$$scope:{ctx:s}}}),{c(){y(e.$$.fragment)},m(t,l){S(e,t,l),n=!0},p(t,l){const a={};l&2&&(a.data=t[1]),l&4100&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function He(s){let e,n,t,l;function a(i){s[7](i)}let u={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Be]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.map=s[0]),n=new _e({props:u}),ae.push(()=>me(n,"map",a)),{c(){e=$("div"),y(n.$$.fragment),P(e,"slot","main"),w(e,"position","relative"),w(e,"width","100%"),w(e,"height","100vh")},m(i,o){k(i,e,o),S(n,e,null),l=!0},p(i,o){const f={};o&4102&&(f.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,f.map=i[0],de(()=>t=!1)),n.$set(f)},i(i){l||(h(n.$$.fragment,i),l=!0)},o(i){b(n.$$.fragment,i),l=!1},d(i){i&&v(e),L(n)}}}function Ae(s){let e,n;return e=new re({props:{$$slots:{main:[He],left:[Me]},$$scope:{ctx:s}}}),{c(){y(e.$$.fragment)},m(t,l){S(e,t,l),n=!0},p(t,[l]){const a={};l&4111&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Fe(s){let e=s.properties.way;window.open(`http://openstreetmap.org/way/${e}`,"_blank")}function B(s){if(s=="lts")return null;if(s=="cost")return ee(1,30);if(s=="nearby_amenities")return ee(0,50)}function ee(s,e){let n=[],t=(e-s)/5;for(let l=0;l<6;l++)n.push(s+l*t);return n}function Ie(s,e,n){oe(async()=>{await ye(),await ge()});let t,l,a={type:"FeatureCollection",features:[]},u="lts",i;async function o(c){try{let p=await i.files[0].arrayBuffer();l=new Se(new Uint8Array(p));let _=l.getBounds();t.fitBounds([[_[0],_[1]],[_[2],_[3]]],{padding:20,animate:!1}),n(1,a=JSON.parse(l.debugNetwork()))}catch(p){window.alert(`Problem loading network file: ${p}`)}}function f(c){if(c=="lts")return $e;if(c=="cost")return X(["/",["get","cost"],["get","length"]],B(c),R);if(c=="nearby_amenities")return X(["get","nearby_amenities"],B(c),R)}const r=c=>Fe(c.detail.features[0]);function d(c){t=c,n(0,t)}function C(c){ae[c?"unshift":"push"](()=>{i=c,n(3,i)})}function T(){u=he(this),n(2,u)}return[t,a,u,i,o,f,r,d,C,T]}class Pe extends te{constructor(e){super(),ne(this,e,Ie,Ae,le,{})}}new Pe({target:document.getElementById("app")});
