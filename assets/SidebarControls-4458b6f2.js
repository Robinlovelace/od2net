import{S as de,i as me,s as pe,Y as ut,x as it,y as ot,c as j,a as B,A as st,t as R,b as M,d as P,Z as ft,G as ct,J as _t,K as dt,N as mt,$ as ee,a0 as je,a1 as Xe,a2 as $e,a3 as Ie,a4 as pt,a5 as T,f as L,l as g,v as h,T as te,D as at,r as bt,u as gt,a6 as Be,a7 as ht,g as C,W as oe,e as b,h as H,n as d,q as O,E as xe,w as Pe,a8 as vt,a9 as wt,j as K,aa as kt,ab as D,z as et,V as ne}from"./Legend-7e8105f0.js";const yt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Me(t,n){const l={},e={},i={$$scope:1};let o=t.length;for(;o--;){const r=t[o],a=n[o];if(a){for(const s in r)s in a||(e[s]=1);for(const s in a)i[s]||(l[s]=a[s],i[s]=1);t[o]=a}else for(const s in r)i[s]=1}for(const r in e)r in l||(l[r]=void 0);return l}function He(t){return typeof t=="object"&&t!==null?t:{}}function Lt(t){let n;const l=t[16].default,e=ct(l,t,t[24],null);return{c(){e&&e.c()},m(i,o){e&&e.m(i,o),n=!0},p(i,o){e&&e.p&&(!n||o&16777216)&&_t(e,l,i,i[24],n?mt(l,i[24],o,null):dt(i[24]),null)},i(i){n||(R(e,i),n=!0)},o(i){M(e,i),n=!1},d(i){e&&e.d(i)}}}function Ct(t){let n,l,e;function i(r){t[17](r)}let o={id:t[1],type:"circle",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[Lt]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.hovered=t[0]),n=new ut({props:o}),it.push(()=>ot(n,"hovered",i)),n.$on("click",t[18]),n.$on("dblclick",t[19]),n.$on("contextmenu",t[20]),n.$on("mouseenter",t[21]),n.$on("mousemove",t[22]),n.$on("mouseleave",t[23]),{c(){j(n.$$.fragment)},m(r,a){B(n,r,a),e=!0},p(r,[a]){const s={};a&2&&(s.id=r[1]),a&4&&(s.source=r[2]),a&8&&(s.sourceLayer=r[3]),a&16&&(s.beforeId=r[4]),a&32&&(s.beforeLayerType=r[5]),a&64&&(s.paint=r[6]),a&128&&(s.layout=r[7]),a&256&&(s.filter=r[8]),a&512&&(s.applyToClusters=r[9]),a&1024&&(s.minzoom=r[10]),a&2048&&(s.maxzoom=r[11]),a&4096&&(s.hoverCursor=r[12]),a&8192&&(s.manageHoverState=r[13]),a&16384&&(s.eventsIfTopMost=r[14]),a&32768&&(s.interactive=r[15]),a&16777216&&(s.$$scope={dirty:a,ctx:r}),!l&&a&1&&(l=!0,s.hovered=r[0],st(()=>l=!1)),n.$set(s)},i(r){e||(R(n.$$.fragment,r),e=!0)},o(r){M(n.$$.fragment,r),e=!1},d(r){P(n,r)}}}function St(t,n,l){let{$$slots:e={},$$scope:i}=n,{id:o=ft("circle")}=n,{source:r=void 0}=n,{sourceLayer:a=void 0}=n,{beforeId:s=void 0}=n,{beforeLayerType:m=void 0}=n,{paint:w}=n,{layout:v=void 0}=n,{filter:k=void 0}=n,{applyToClusters:u=void 0}=n,{minzoom:_=void 0}=n,{maxzoom:z=void 0}=n,{hoverCursor:I=void 0}=n,{manageHoverState:N=!1}=n,{hovered:S=null}=n,{eventsIfTopMost:E=!1}=n,{interactive:y=!0}=n;function A(c){S=c,l(0,S)}function F(c){ee.call(this,t,c)}function se(c){ee.call(this,t,c)}function G(c){ee.call(this,t,c)}function ae(c){ee.call(this,t,c)}function Q(c){ee.call(this,t,c)}function le(c){ee.call(this,t,c)}return t.$$set=c=>{"id"in c&&l(1,o=c.id),"source"in c&&l(2,r=c.source),"sourceLayer"in c&&l(3,a=c.sourceLayer),"beforeId"in c&&l(4,s=c.beforeId),"beforeLayerType"in c&&l(5,m=c.beforeLayerType),"paint"in c&&l(6,w=c.paint),"layout"in c&&l(7,v=c.layout),"filter"in c&&l(8,k=c.filter),"applyToClusters"in c&&l(9,u=c.applyToClusters),"minzoom"in c&&l(10,_=c.minzoom),"maxzoom"in c&&l(11,z=c.maxzoom),"hoverCursor"in c&&l(12,I=c.hoverCursor),"manageHoverState"in c&&l(13,N=c.manageHoverState),"hovered"in c&&l(0,S=c.hovered),"eventsIfTopMost"in c&&l(14,E=c.eventsIfTopMost),"interactive"in c&&l(15,y=c.interactive),"$$scope"in c&&l(24,i=c.$$scope)},[S,o,r,a,s,m,w,v,k,u,_,z,I,N,E,y,e,A,F,se,G,ae,Q,le,i]}class tt extends de{constructor(n){super(),me(this,n,St,Ct,pe,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}let Ne=je(!0),De=je(!1),qe=je(!1);function nt(t){let n,l;return n=new Be({props:{$$slots:{default:[Tt,({props:e})=>({8:e}),({props:e})=>e?256:0]},$$scope:{ctx:t}}}),{c(){j(n.$$.fragment)},m(e,i){B(n,e,i),l=!0},p(e,i){const o={};i&768&&(o.$$scope={dirty:i,ctx:e}),n.$set(o)},i(e){l||(R(n.$$.fragment,e),l=!0)},o(e){M(n.$$.fragment,e),l=!1},d(e){P(n,e)}}}function Tt(t){let n,l;return n=new ht({props:{properties:t[8]}}),{c(){j(n.$$.fragment)},m(e,i){B(n,e,i),l=!0},p(e,i){const o={};i&256&&(o.properties=e[8]),n.$set(o)},i(e){l||(R(n.$$.fragment,e),l=!0)},o(e){M(n.$$.fragment,e),l=!1},d(e){P(n,e)}}}function Ot(t){let n,l,e=t[2]&&nt(t);return{c(){e&&e.c(),n=at()},m(i,o){e&&e.m(i,o),g(i,n,o),l=!0},p(i,o){i[2]?e?(e.p(i,o),o&4&&R(e,1)):(e=nt(i),e.c(),R(e,1),e.m(n.parentNode,n)):e&&(bt(),M(e,1,1,()=>{e=null}),gt())},i(i){l||(R(e),l=!0)},o(i){M(e),l=!1},d(i){i&&h(n),e&&e.d(i)}}}function Rt(t){let n=t[8].origin_count+"",l,e;return{c(){l=C(n),e=C(" routes start here")},m(i,o){g(i,l,o),g(i,e,o)},p(i,o){o&256&&n!==(n=i[8].origin_count+"")&&oe(l,n)},d(i){i&&(h(l),h(e))}}}function zt(t){let n,l;return n=new Be({props:{$$slots:{default:[Rt,({props:e})=>({8:e}),({props:e})=>e?256:0]},$$scope:{ctx:t}}}),{c(){j(n.$$.fragment)},m(e,i){B(n,e,i),l=!0},p(e,i){const o={};i&768&&(o.$$scope={dirty:i,ctx:e}),n.$set(o)},i(e){l||(R(n.$$.fragment,e),l=!0)},o(e){M(n.$$.fragment,e),l=!1},d(e){P(n,e)}}}function It(t){let n=t[8].destination_count+"",l,e;return{c(){l=C(n),e=C(" routes end here")},m(i,o){g(i,l,o),g(i,e,o)},p(i,o){o&256&&n!==(n=i[8].destination_count+"")&&oe(l,n)},d(i){i&&(h(l),h(e))}}}function Mt(t){let n,l;return n=new Be({props:{$$slots:{default:[It,({props:e})=>({8:e}),({props:e})=>e?256:0]},$$scope:{ctx:t}}}),{c(){j(n.$$.fragment)},m(e,i){B(n,e,i),l=!0},p(e,i){const o={};i&768&&(o.$$scope={dirty:i,ctx:e}),n.$set(o)},i(e){l||(R(n.$$.fragment,e),l=!0)},o(e){M(n.$$.fragment,e),l=!1},d(e){P(n,e)}}}function Ht(t){let n,l,e,i,o,r;const a=[{id:"input-layer"},t[0],{filter:["==",["geometry-type"],"LineString"]},{manageHoverState:!0},{hoverCursor:t[2]?"pointer":void 0},{paint:{"line-width":t[3],"line-color":Xe,"line-opacity":$e(1,.5)}},{layout:{visibility:t[4]?"visible":"none"}},{beforeId:"Road labels"}];let s={$$slots:{default:[Ot]},$$scope:{ctx:t}};for(let u=0;u<a.length;u+=1)s=Ie(s,a[u]);n=new pt({props:s}),n.$on("click",t[7]);const m=[{id:"origins-layer"},t[0],{filter:["has","origin_count"]},{manageHoverState:!0},{paint:{"circle-color":T.origins,"circle-radius":t[1].originRadius}},{layout:{visibility:t[5]?"visible":"none"}}];let w={$$slots:{default:[zt]},$$scope:{ctx:t}};for(let u=0;u<m.length;u+=1)w=Ie(w,m[u]);e=new tt({props:w});const v=[{id:"destinations-layer"},t[0],{filter:["has","destination_count"]},{manageHoverState:!0},{paint:{"circle-color":T.destinations,"circle-radius":t[1].destinationRadius}},{layout:{visibility:t[6]?"visible":"none"}}];let k={$$slots:{default:[Mt]},$$scope:{ctx:t}};for(let u=0;u<v.length;u+=1)k=Ie(k,v[u]);return o=new tt({props:k}),{c(){j(n.$$.fragment),l=L(),j(e.$$.fragment),i=L(),j(o.$$.fragment)},m(u,_){B(n,u,_),g(u,l,_),B(e,u,_),g(u,i,_),B(o,u,_),r=!0},p(u,[_]){const z=_&29?Me(a,[a[0],_&1&&He(u[0]),a[2],a[3],_&4&&{hoverCursor:u[2]?"pointer":void 0},_&8&&{paint:{"line-width":u[3],"line-color":Xe,"line-opacity":$e(1,.5)}},_&16&&{layout:{visibility:u[4]?"visible":"none"}},a[7]]):{};_&516&&(z.$$scope={dirty:_,ctx:u}),n.$set(z);const I=_&35?Me(m,[m[0],_&1&&He(u[0]),m[2],m[3],_&2&&{paint:{"circle-color":T.origins,"circle-radius":u[1].originRadius}},_&32&&{layout:{visibility:u[5]?"visible":"none"}}]):{};_&512&&(I.$$scope={dirty:_,ctx:u}),e.$set(I);const N=_&67?Me(v,[v[0],_&1&&He(u[0]),v[2],v[3],_&2&&{paint:{"circle-color":T.destinations,"circle-radius":u[1].destinationRadius}},_&64&&{layout:{visibility:u[6]?"visible":"none"}}]):{};_&512&&(N.$$scope={dirty:_,ctx:u}),o.$set(N)},i(u){r||(R(n.$$.fragment,u),R(e.$$.fragment,u),R(o.$$.fragment,u),r=!0)},o(u){M(n.$$.fragment,u),M(e.$$.fragment,u),M(o.$$.fragment,u),r=!1},d(u){u&&(h(l),h(i)),P(n,u),P(e,u),P(o,u)}}}function Nt(t){let n=0,l=2,e=10,i=t-n,o=e-l;return["+",l,["*",o,["min",1,["/",["-",["get","count"],n],i]]]]}function Dt(t,n,l){let e,i,o,r,a;te(t,Ne,v=>l(4,o=v)),te(t,De,v=>l(5,r=v)),te(t,qe,v=>l(6,a=v));let{sourceOverride:s={}}=n,{controls:m}=n;function w(v){if(!e)return;let k=v.detail.features[0].properties.way;window.open(`http://openstreetmap.org/way/${k}`,"_blank")}return t.$$set=v=>{"sourceOverride"in v&&l(0,s=v.sourceOverride),"controls"in v&&l(1,m=v.controls)},t.$$.update=()=>{t.$$.dirty&2&&l(2,e=!m.streetviewOn),t.$$.dirty&2&&l(3,i=Nt(m.maxCount))},[s,m,e,i,o,r,a,w]}class Ft extends de{constructor(n){super(),me(this,n,Dt,Ht,pe,{sourceOverride:0,controls:1})}}const{window:qt}=yt;function lt(t){let n,l,e,i,o,r,a,s,m,w,v;return m=wt(t[6][0]),{c(){n=b("div"),l=b("label"),e=b("input"),i=C(`
      Google StreetView`),o=L(),r=b("label"),a=b("input"),s=C(`
      Bing Streetside`),H(e,"type","radio"),e.__value="google",K(e,e.__value),H(a,"type","radio"),a.__value="bing",K(a,a.__value),m.p(e,a)},m(k,u){g(k,n,u),d(n,l),d(l,e),e.checked=e.__value===t[1],d(l,i),d(n,o),d(n,r),d(r,a),a.checked=a.__value===t[1],d(r,s),w||(v=[O(e,"change",t[5]),O(a,"change",t[7])],w=!0)},p(k,u){u&2&&(e.checked=e.__value===k[1]),u&2&&(a.checked=a.__value===k[1])},d(k){k&&h(n),m.r(),w=!1,Pe(v)}}}function jt(t){let n,l,e,i,o,r,a,s=t[0]&&lt(t);return{c(){n=b("label"),l=b("input"),e=C(`
  StreetView`),i=L(),s&&s.c(),o=at(),H(l,"type","checkbox")},m(m,w){g(m,n,w),d(n,l),l.checked=t[0],d(n,e),g(m,i,w),s&&s.m(m,w),g(m,o,w),r||(a=[O(qt,"keydown",t[2]),O(l,"change",t[4])],r=!0)},p(m,[w]){w&1&&(l.checked=m[0]),m[0]?s?s.p(m,w):(s=lt(m),s.c(),s.m(o.parentNode,o)):s&&(s.d(1),s=null)},i:xe,o:xe,d(m){m&&(h(n),h(i),h(o)),s&&s.d(m),r=!1,Pe(a)}}}function Bt(t,n,l){let{map:e}=n,{enabled:i=!1}=n,o="google";function r(){e.on("click",s),e.getCanvas().style.cursor="zoom-in"}function a(){e.off("click",s),e.getCanvas().style.cursor="auto"}vt(a);function s(_){let z=_.lngLat.lng,I=_.lngLat.lat;o=="google"?window.open(`http://maps.google.com/maps?q=&layer=c&cbll=${I},${z}&cbp=11,0,0,0,0`,"_blank"):o=="bing"&&window.open(`https://www.bing.com/maps?cp=${I}~${z}&style=x`,"_blank")}function m(_){i&&_.key=="Escape"&&l(0,i=!1)}const w=[[]];function v(){i=this.checked,l(0,i)}function k(){o=this.__value,l(1,o)}function u(){o=this.__value,l(1,o)}return t.$$set=_=>{"map"in _&&l(3,e=_.map),"enabled"in _&&l(0,i=_.enabled)},t.$$.update=()=>{t.$$.dirty&1&&(i?r():a())},[i,o,m,e,v,k,w,u]}class Pt extends de{constructor(n){super(),me(this,n,Bt,jt,pe,{map:3,enabled:0})}}function Vt(t){let n,l=t[1].config.requests.description+"",e,i,o,r,a,s,m,w,v,k,u,_,z,I,N,S,E,y,A,F,se,G,ae,Q=t[1].num_origins.toLocaleString()+"",le,c,be,re,U,Ve,We,Ee,V,ge,ue,ie,X,Fe,$,Ge,fe=t[1].num_destinations.toLocaleString()+"",he,Je,ve,ce,x,Ke,Ae,Ye,W,we,ke,ye,Y,Le,_e,Ce,Se,Te,J,Oe,Z,Re,Ze;Y=new kt({props:{rows:[[`${D.lts1}: ${q(t[1].total_meters_lts1)}`,T.lts1],[`${D.lts2}: ${q(t[1].total_meters_lts2)}`,T.lts2],[`${D.lts3}: ${q(t[1].total_meters_lts3)}`,T.lts3],[`${D.lts4}: ${q(t[1].total_meters_lts4)}`,T.lts4],[`${D.lts_not_allowed}: ${q(t[1].total_meters_not_allowed)}`,T.lts_not_allowed]]}});function rt(f){t[16](f)}let Qe={map:t[2]};return t[0].streetviewOn!==void 0&&(Qe.enabled=t[0].streetviewOn),J=new Pt({props:Qe}),it.push(()=>ot(J,"enabled",rt)),{c(){n=b("p"),e=C(l),i=L(),o=b("div"),r=b("button"),r.textContent="See all output details",a=L(),s=b("div"),m=b("label"),w=b("input"),v=C(`
    Route network`),k=L(),u=b("div"),_=b("label"),z=C(`Max for line width styling:
    `),I=b("br"),N=L(),S=b("input"),E=L(),y=b("div"),A=b("label"),F=b("input"),se=L(),G=b("span"),ae=C("Origins ("),le=C(Q),c=C(")"),be=L(),re=b("div"),U=b("label"),Ve=C(`Change origin point size:
    `),We=b("br"),Ee=L(),V=b("input"),ge=L(),ue=b("div"),ie=b("label"),X=b("input"),Fe=L(),$=b("span"),Ge=C("Destinations ("),he=C(fe),Je=C(")"),ve=L(),ce=b("div"),x=b("label"),Ke=C(`Change destination point size:
    `),Ae=b("br"),Ye=L(),W=b("input"),we=L(),ke=b("hr"),ye=L(),j(Y.$$.fragment),Le=L(),_e=b("p"),_e.innerHTML='Note: LTS model from <a href="https://github.com/BikeOttawa/stressmodel/blob/master/stressmodel.js" target="_blank">BikeOttawa</a>',Ce=L(),Se=b("hr"),Te=L(),j(J.$$.fragment),H(w,"type","checkbox"),H(S,"type","number"),H(S,"min",1),H(F,"type","checkbox"),et(G,"color",T.origins),H(V,"type","number"),H(V,"min",1),H(X,"type","checkbox"),et($,"color",T.destinations),H(W,"type","number"),H(W,"min",1)},m(f,p){g(f,n,p),d(n,e),g(f,i,p),g(f,o,p),d(o,r),g(f,a,p),g(f,s,p),d(s,m),d(m,w),w.checked=t[3],d(m,v),g(f,k,p),g(f,u,p),d(u,_),d(_,z),d(_,I),d(_,N),d(_,S),K(S,t[0].maxCount),g(f,E,p),g(f,y,p),d(y,A),d(A,F),F.checked=t[4],d(A,se),d(A,G),d(G,ae),d(G,le),d(G,c),g(f,be,p),g(f,re,p),d(re,U),d(U,Ve),d(U,We),d(U,Ee),d(U,V),K(V,t[0].originRadius),g(f,ge,p),g(f,ue,p),d(ue,ie),d(ie,X),X.checked=t[5],d(ie,Fe),d(ie,$),d($,Ge),d($,he),d($,Je),g(f,ve,p),g(f,ce,p),d(ce,x),d(x,Ke),d(x,Ae),d(x,Ye),d(x,W),K(W,t[0].destinationRadius),g(f,we,p),g(f,ke,p),g(f,ye,p),B(Y,f,p),g(f,Le,p),g(f,_e,p),g(f,Ce,p),g(f,Se,p),g(f,Te,p),B(J,f,p),Z=!0,Re||(Ze=[O(r,"click",t[6]),O(w,"change",t[7]),O(S,"input",t[8]),O(S,"change",t[9]),O(F,"change",t[10]),O(V,"input",t[11]),O(V,"change",t[12]),O(X,"change",t[13]),O(W,"input",t[14]),O(W,"change",t[15])],Re=!0)},p(f,[p]){(!Z||p&2)&&l!==(l=f[1].config.requests.description+"")&&oe(e,l),p&8&&(w.checked=f[3]),p&1&&ne(S.value)!==f[0].maxCount&&K(S,f[0].maxCount),p&16&&(F.checked=f[4]),(!Z||p&2)&&Q!==(Q=f[1].num_origins.toLocaleString()+"")&&oe(le,Q),p&1&&ne(V.value)!==f[0].originRadius&&K(V,f[0].originRadius),p&32&&(X.checked=f[5]),(!Z||p&2)&&fe!==(fe=f[1].num_destinations.toLocaleString()+"")&&oe(he,fe),p&1&&ne(W.value)!==f[0].destinationRadius&&K(W,f[0].destinationRadius);const Ue={};p&2&&(Ue.rows=[[`${D.lts1}: ${q(f[1].total_meters_lts1)}`,T.lts1],[`${D.lts2}: ${q(f[1].total_meters_lts2)}`,T.lts2],[`${D.lts3}: ${q(f[1].total_meters_lts3)}`,T.lts3],[`${D.lts4}: ${q(f[1].total_meters_lts4)}`,T.lts4],[`${D.lts_not_allowed}: ${q(f[1].total_meters_not_allowed)}`,T.lts_not_allowed]]),Y.$set(Ue);const ze={};p&4&&(ze.map=f[2]),!Oe&&p&1&&(Oe=!0,ze.enabled=f[0].streetviewOn,st(()=>Oe=!1)),J.$set(ze)},i(f){Z||(R(Y.$$.fragment,f),R(J.$$.fragment,f),Z=!0)},o(f){M(Y.$$.fragment,f),M(J.$$.fragment,f),Z=!1},d(f){f&&(h(n),h(i),h(o),h(a),h(s),h(k),h(u),h(E),h(y),h(be),h(re),h(ge),h(ue),h(ve),h(ce),h(we),h(ke),h(ye),h(Le),h(_e),h(Ce),h(Se),h(Te)),P(Y,f),P(J,f),Re=!1,Pe(Ze)}}}function q(t){return`${(t/1e3).toFixed(1)} km total for all trips (before uptake)`}function Wt(t,n,l){let e,i,o;te(t,Ne,y=>l(3,e=y)),te(t,De,y=>l(4,i=y)),te(t,qe,y=>l(5,o=y));let{outputMetadata:r}=n,{map:a}=n,{controls:s}=n;const m=()=>window.alert(JSON.stringify(r,null,"  "));function w(){e=this.checked,Ne.set(e)}function v(){s.maxCount=ne(this.value),l(0,s)}const k=()=>l(0,s);function u(){i=this.checked,De.set(i)}function _(){s.originRadius=ne(this.value),l(0,s)}const z=()=>l(0,s);function I(){o=this.checked,qe.set(o)}function N(){s.destinationRadius=ne(this.value),l(0,s)}const S=()=>l(0,s);function E(y){t.$$.not_equal(s.streetviewOn,y)&&(s.streetviewOn=y,l(0,s))}return t.$$set=y=>{"outputMetadata"in y&&l(1,r=y.outputMetadata),"map"in y&&l(2,a=y.map),"controls"in y&&l(0,s=y.controls)},[s,r,a,e,i,o,m,w,v,k,u,_,z,I,N,S,E]}class Gt extends de{constructor(n){super(),me(this,n,Wt,Vt,pe,{outputMetadata:1,map:2,controls:0})}}export{Ft as L,Gt as S};
