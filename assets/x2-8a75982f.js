import{S as K,i as U,s as Z,G as he,e as w,h as H,z as J,l as C,I as Y,q as z,J as be,K as ye,N as we,O as ve,t as k,b as O,v as M,w as re,Q as ke,R as Le,T as W,U as $,m as Ce,g as R,f as B,D as ue,j,k as Me,n as b,p as x,E as P,V as ee,W as Oe,X as ze,Y as F,C as He,L as Se,c as D,a as E,d as I,o as Te,H as Be,r as te,u as ne,M as De,x as G,y as Q,A as V,_ as Ee,Z as Ie}from"./Legend-2db49f7e.js";import{_ as je,J as Ae,G as Ne}from"./@vite-plugin-wasm-pack@wasm-od2net-8cae2080.js";import{S as qe,L as Je}from"./SidebarControls-1356fd97.js";function Re(l){let e,n,a,t,s,o,u;const i=l[16].default,f=he(i,l,l[15],null);return{c(){e=w("div"),f&&f.c(),H(e,"tabindex",n=l[1]?0:void 0),H(e,"role",a=l[1]?"button":void 0),J(e,"z-index",l[2])},m(r,d){C(r,e,d),f&&f.m(e,null),s=!0,o||(u=[Y(l[6].call(null,e)),Y(t=Pe.call(null,e,l[0])),z(e,"click",l[17]),z(e,"dblclick",l[18]),z(e,"contextmenu",l[19]),z(e,"mouseenter",l[20]),z(e,"mouseleave",l[21]),z(e,"mousemove",l[22]),z(e,"keydown",l[7])],o=!0)},p(r,[d]){f&&f.p&&(!s||d&32768)&&be(f,i,r,r[15],s?we(i,r[15],d,null):ye(r[15]),null),(!s||d&2&&n!==(n=r[1]?0:void 0))&&H(e,"tabindex",n),(!s||d&2&&a!==(a=r[1]?"button":void 0))&&H(e,"role",a),t&&ve(t.update)&&d&1&&t.update.call(null,r[0]),d&4&&J(e,"z-index",r[2])},i(r){s||(k(f,r),s=!0)},o(r){O(f,r),s=!1},d(r){r&&M(e),f&&f.d(r),o=!1,re(u)}}}function Pe(l,e){const n=l.className;function a(t){t?l.className=`${n} ${t}`:l.className=n}return a(e),{update:a}}function Fe(l,e,n){let a,t,s,{$$slots:o={},$$scope:u}=e,{lngLat:i}=e,{class:f=void 0}=e,{interactive:r=!0}=e,{asButton:d=!1}=e,{draggable:_=!1}=e,{feature:g=null}=e,{offset:v=void 0}=e,{zIndex:y=void 0}=e;const m=ke(),{map:h,layerEvent:p,self:L}=Le();W(l,h,c=>n(24,s=c)),W(l,p,c=>n(23,a=c)),W(l,L,c=>n(14,t=c));function T(c){$(L,t=new Ce.Marker({element:c,draggable:_,offset:v}).setLngLat(i).addTo(s),t);const A=()=>S("dragstart"),N=()=>{X(),S("drag")},q=()=>{X(),S("dragend")};return _&&(t.on("dragstart",A),t.on("drag",N),t.on("dragend",q)),{destroy(){_&&(t==null||t.off("dragstart",A),t==null||t.off("drag",N),t==null||t.off("dragend",q)),t==null||t.remove()}}}function X(){let c=t==null?void 0:t.getLngLat();c&&(Array.isArray(i)?n(9,i=[c.lng,c.lat]):i&&"lon"in i?n(9,i={lon:c.lng,lat:c.lat}):n(9,i=c))}function fe(c){c.key===" "&&(c.preventDefault(),c.stopPropagation(),S("click"))}function S(c){if(!r)return;let A=t==null?void 0:t.getLngLat();if(!A)return;const N=[A.lng,A.lat];let q={map:s,marker:t,lngLat:N,features:[{type:"Feature",properties:(g==null?void 0:g.properties)??{},geometry:{type:"Point",coordinates:N}}]};$(p,a={...q,layerType:"marker",type:c},a),m(c,q)}const ce=()=>S("click"),de=()=>S("dblclick"),_e=()=>S("contextmenu"),me=c=>{S("mouseenter")},pe=()=>{S("mouseleave")},ge=()=>S("mousemove");return l.$$set=c=>{"lngLat"in c&&n(9,i=c.lngLat),"class"in c&&n(0,f=c.class),"interactive"in c&&n(10,r=c.interactive),"asButton"in c&&n(1,d=c.asButton),"draggable"in c&&n(11,_=c.draggable),"feature"in c&&n(12,g=c.feature),"offset"in c&&n(13,v=c.offset),"zIndex"in c&&n(2,y=c.zIndex),"$$scope"in c&&n(15,u=c.$$scope)},l.$$.update=()=>{l.$$.dirty&16896&&(t==null||t.setLngLat(i)),l.$$.dirty&24576&&(t==null||t.setOffset(v??[0,0]))},[f,d,y,h,p,L,T,fe,S,i,r,_,g,v,t,u,o,ce,de,_e,me,pe,ge]}class Ge extends K{constructor(e){super(),U(this,e,Fe,Re,Z,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2})}}const We='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function le(l,e,n){const a=l.slice();return a[7]=e[n],a[8]=e,a[9]=n,a}function ae(l){let e,n=ee(Object.keys(l[2])),a=[];for(let t=0;t<n.length;t+=1)a[t]=se(le(l,n,t));return{c(){e=w("ul");for(let t=0;t<a.length;t+=1)a[t].c()},m(t,s){C(t,e,s);for(let o=0;o<a.length;o+=1)a[o]&&a[o].m(e,null)},p(t,s){if(s&5){n=ee(Object.keys(t[2]));let o;for(o=0;o<n.length;o+=1){const u=le(t,n,o);a[o]?a[o].p(u,s):(a[o]=se(u),a[o].c(),a[o].m(e,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=n.length}},d(t){t&&M(e),Oe(a,t)}}}function se(l){let e,n,a=l[7]+"",t,s,o,u,i;function f(){l[4].call(s,l[7])}return{c(){e=w("li"),n=w("label"),t=R(a),s=w("input"),o=B(),H(s,"type","number"),H(s,"min","1.0"),H(s,"step","0.1")},m(r,d){C(r,e,d),b(e,n),b(n,t),b(n,s),j(s,l[2][l[7]]),b(e,o),u||(i=[z(s,"input",f),z(s,"change",l[5])],u=!0)},p(r,d){l=r,d&4&&a!==(a=l[7]+"")&&ze(t,a),d&4&&F(s.value)!==l[2][l[7]]&&j(s,l[2][l[7]])},d(r){r&&M(e),u=!1,re(i)}}}function Ke(l){let e,n,a,t,s,o,u,i,f,r,d,_=l[1]=="OsmHighwayType"&&ae(l);return{c(){e=w("div"),n=w("label"),a=R(`Cost function:
    `),t=w("select"),s=w("option"),s.textContent="Distance",o=w("option"),o.textContent="Avoid main roads",u=w("option"),u.textContent="Set a weight per OSM highway type",i=B(),_&&_.c(),f=ue(),s.__value="Distance",j(s,s.__value),o.__value="AvoidMainRoads",j(o,o.__value),u.__value="OsmHighwayType",j(u,u.__value),l[1]===void 0&&Me(()=>l[3].call(t))},m(g,v){C(g,e,v),b(e,n),b(n,a),b(n,t),b(t,s),b(t,o),b(t,u),x(t,l[1],!0),C(g,i,v),_&&_.m(g,v),C(g,f,v),r||(d=z(t,"change",l[3]),r=!0)},p(g,[v]){v&2&&x(t,g[1]),g[1]=="OsmHighwayType"?_?_.p(g,v):(_=ae(g),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i:P,o:P,d(g){g&&(M(e),M(i),M(f)),_&&_.d(g),r=!1,d()}}}function Ue(l,e,n){let{cost:a}=e,t="Distance",s={};for(let r of["cycleway","footway","living_street","motorway","motorway_link","path","pedestrian","primary","primary_link","residential","secondary","secondary_link","service","steps","tertiary","tertiary_link","track","trunk","trunk_link","unclassified"])s[r]=1;function o(r){r=="OsmHighwayType"?n(0,a={OsmHighwayType:s}):n(0,a=r)}function u(){t=He(this),n(1,t)}function i(r){s[r]=F(this.value),n(2,s)}const f=()=>n(0,a);return l.$$set=r=>{"cost"in r&&n(0,a=r.cost)},l.$$.update=()=>{l.$$.dirty&2&&o(t)},[a,t,s,u,i,f]}class Ze extends K{constructor(e){super(),U(this,e,Ue,Ke,Z,{cost:0})}}function ie(l){let e,n,a,t,s,o,u,i,f,r,d,_;function g(y){l[14](y)}let v={};return l[1]!==void 0&&(v.cost=l[1]),i=new Ze({props:v}),G.push(()=>Q(i,"cost",g)),{c(){e=w("div"),n=w("label"),a=R("Max requests (limit for faster updates):"),t=w("br"),s=B(),o=w("input"),u=B(),D(i.$$.fragment),H(o,"type","number"),H(o,"min",1)},m(y,m){C(y,e,m),b(e,n),b(n,a),b(n,t),b(n,s),b(n,o),j(o,l[0]),C(y,u,m),E(i,y,m),r=!0,d||(_=z(o,"input",l[13]),d=!0)},p(y,m){m&1&&F(o.value)!==y[0]&&j(o,y[0]);const h={};!f&&m&2&&(f=!0,h.cost=y[1],V(()=>f=!1)),i.$set(h)},i(y){r||(k(i.$$.fragment,y),r=!0)},o(y){O(i.$$.fragment,y),r=!1},d(y){y&&(M(e),M(u)),I(i,y),d=!1,_()}}}function oe(l){let e,n,a,t;return a=new qe({props:{outputMetadata:l[5].metadata,map:l[2],controls:l[7]}}),{c(){e=w("hr"),n=B(),D(a.$$.fragment)},m(s,o){C(s,e,o),C(s,n,o),E(a,s,o),t=!0},p(s,o){const u={};o&32&&(u.outputMetadata=s[5].metadata),o&4&&(u.map=s[2]),a.$set(u)},i(s){t||(k(a.$$.fragment,s),t=!0)},o(s){O(a.$$.fragment,s),t=!1},d(s){s&&(M(e),M(n)),I(a,s)}}}function Qe(l){let e,n,a,t,s,o,u,i,f,r,d,_,g,v,y;n=new Be({props:{app:"interactive"}});let m=l[3]&&ie(l),h=l[5].metadata&&oe(l);return{c(){e=w("div"),D(n.$$.fragment),a=B(),t=w("label"),s=R("Open a "),o=w("i"),o.textContent=".bin",u=R(" network file or an "),i=w("i"),i.textContent=".osm.pbf",f=B(),r=w("input"),d=B(),m&&m.c(),_=B(),h&&h.c(),H(r,"type","file"),H(e,"slot","left")},m(p,L){C(p,e,L),E(n,e,null),b(e,a),b(e,t),b(t,s),b(t,o),b(t,u),b(t,i),b(t,f),b(t,r),l[12](r),b(e,d),m&&m.m(e,null),b(e,_),h&&h.m(e,null),g=!0,v||(y=z(r,"change",l[8]),v=!0)},p(p,L){p[3]?m?(m.p(p,L),L&8&&k(m,1)):(m=ie(p),m.c(),k(m,1),m.m(e,_)):m&&(te(),O(m,1,1,()=>{m=null}),ne()),p[5].metadata?h?(h.p(p,L),L&32&&k(h,1)):(h=oe(p),h.c(),k(h,1),h.m(e,null)):h&&(te(),O(h,1,1,()=>{h=null}),ne())},i(p){g||(k(n.$$.fragment,p),k(m),k(h),g=!0)},o(p){O(n.$$.fragment,p),O(m),O(h),g=!1},d(p){p&&M(e),I(n),l[12](null),m&&m.d(),h&&h.d(),v=!1,y()}}}function Ve(l){let e,n;return{c(){e=new Ie(!1),n=ue(),e.a=n},m(a,t){e.m(We,a,t),C(a,n,t)},p:P,d(a){a&&(M(n),e.d())}}}function Xe(l){let e,n;return e=new Je({props:{controls:l[7]}}),{c(){D(e.$$.fragment)},m(a,t){E(e,a,t),n=!0},p:P,i(a){n||(k(e.$$.fragment,a),n=!0)},o(a){O(e.$$.fragment,a),n=!1},d(a){I(e,a)}}}function Ye(l){let e,n,a,t,s;function o(i){l[10](i)}let u={draggable:!0,$$slots:{default:[Ve]},$$scope:{ctx:l}};return l[4]!==void 0&&(u.lngLat=l[4]),e=new Ge({props:u}),G.push(()=>Q(e,"lngLat",o)),e.$on("dragend",l[9]),t=new Ne({props:{data:l[5],$$slots:{default:[Xe]},$$scope:{ctx:l}}}),{c(){D(e.$$.fragment),a=B(),D(t.$$.fragment)},m(i,f){E(e,i,f),C(i,a,f),E(t,i,f),s=!0},p(i,f){const r={};f&32768&&(r.$$scope={dirty:f,ctx:i}),!n&&f&16&&(n=!0,r.lngLat=i[4],V(()=>n=!1)),e.$set(r);const d={};f&32&&(d.data=i[5]),f&32768&&(d.$$scope={dirty:f,ctx:i}),t.$set(d)},i(i){s||(k(e.$$.fragment,i),k(t.$$.fragment,i),s=!0)},o(i){O(e.$$.fragment,i),O(t.$$.fragment,i),s=!1},d(i){i&&M(a),I(e,i),I(t,i)}}}function $e(l){let e,n,a,t;function s(u){l[11](u)}let o={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Ye]},$$scope:{ctx:l}};return l[2]!==void 0&&(o.map=l[2]),n=new De({props:o}),G.push(()=>Q(n,"map",s)),{c(){e=w("div"),D(n.$$.fragment),H(e,"slot","main"),J(e,"position","relative"),J(e,"width","100%"),J(e,"height","100vh")},m(u,i){C(u,e,i),E(n,e,null),t=!0},p(u,i){const f={};i&32816&&(f.$$scope={dirty:i,ctx:u}),!a&&i&4&&(a=!0,f.map=u[2],V(()=>a=!1)),n.$set(f)},i(u){t||(k(n.$$.fragment,u),t=!0)},o(u){O(n.$$.fragment,u),t=!1},d(u){u&&M(e),I(n)}}}function xe(l){let e,n;return e=new Se({props:{$$slots:{main:[$e],left:[Qe]},$$scope:{ctx:l}}}),{c(){D(e.$$.fragment)},m(a,t){E(e,a,t),n=!0},p(a,[t]){const s={};t&32895&&(s.$$scope={dirty:t,ctx:a}),e.$set(s)},i(a){n||(k(e.$$.fragment,a),n=!0)},o(a){O(e.$$.fragment,a),n=!1},d(a){I(e,a)}}}function et(l,e,n){Te(async()=>{await je(),await Ee()});let a,t,s={lng:0,lat:0},o={type:"FeatureCollection",features:[]},u=1e3,i="Distance",f={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},r;async function d(p){try{let L=await r.files[0].arrayBuffer();n(3,t=new Ae(new Uint8Array(L)));let T=t.getBounds();a.fitBounds([[T[0],T[1]],[T[2],T[3]]],{padding:20,animate:!1}),n(4,s.lng=(T[0]+T[2])/2,s),n(4,s.lat=(T[1]+T[3])/2,s),_()}catch(L){window.alert(`Problem loading network file: ${L}`)}}function _(){t&&n(5,o=JSON.parse(t.recalculate({lng:s.lng,lat:s.lat,max_requests:u,cost:i})))}function g(p){s=p,n(4,s)}function v(p){a=p,n(2,a)}function y(p){G[p?"unshift":"push"](()=>{r=p,n(6,r)})}function m(){u=F(this.value),n(0,u)}function h(p){i=p,n(1,i)}return l.$$.update=()=>{l.$$.dirty&3&&_()},[u,i,a,t,s,o,r,f,d,_,g,v,y,m,h]}class tt extends K{constructor(e){super(),U(this,e,et,xe,Z,{})}}new tt({target:document.getElementById("app")});
