import{S as $,i as x,s as ee,G as fe,e as C,h as E,z as P,l as I,I as U,q as B,J as ce,K as de,N as me,O as ge,t as w,b as k,v as S,w as pe,Q as _e,R as be,T,U as W,m as he,L as we,c as D,a as J,d as N,o as Le,H as ve,f as q,g as H,n as h,r as Q,u as V,M as ye,x as R,y as F,A as G,_ as ke,V as te,j as Z,E as ne,D as Ce,W as Me}from"./Legend-8c5ea55c.js";import{_ as ze,J as Be,C as Ee,G as Ie}from"./CostFunction-1c17c3c6.js";import{S as Se,L as qe}from"./SidebarControls-432b8271.js";function De(a){let e,n,s,t,o,c,f;const l=a[16].default,u=fe(l,a,a[15],null);return{c(){e=C("div"),u&&u.c(),E(e,"tabindex",n=a[1]?0:void 0),E(e,"role",s=a[1]?"button":void 0),P(e,"z-index",a[2])},m(i,p){I(i,e,p),u&&u.m(e,null),o=!0,c||(f=[U(a[6].call(null,e)),U(t=Je.call(null,e,a[0])),B(e,"click",a[17]),B(e,"dblclick",a[18]),B(e,"contextmenu",a[19]),B(e,"mouseenter",a[20]),B(e,"mouseleave",a[21]),B(e,"mousemove",a[22]),B(e,"keydown",a[7])],c=!0)},p(i,[p]){u&&u.p&&(!o||p&32768)&&ce(u,l,i,i[15],o?me(l,i[15],p,null):de(i[15]),null),(!o||p&2&&n!==(n=i[1]?0:void 0))&&E(e,"tabindex",n),(!o||p&2&&s!==(s=i[1]?"button":void 0))&&E(e,"role",s),t&&ge(t.update)&&p&1&&t.update.call(null,i[0]),p&4&&P(e,"z-index",i[2])},i(i){o||(w(u,i),o=!0)},o(i){k(u,i),o=!1},d(i){i&&S(e),u&&u.d(i),c=!1,pe(f)}}}function Je(a,e){const n=a.className;function s(t){t?a.className=`${n} ${t}`:a.className=n}return s(e),{update:s}}function Ne(a,e,n){let s,t,o,{$$slots:c={},$$scope:f}=e,{lngLat:l}=e,{class:u=void 0}=e,{interactive:i=!0}=e,{asButton:p=!1}=e,{draggable:b=!1}=e,{feature:L=null}=e,{offset:y=void 0}=e,{zIndex:_=void 0}=e;const d=_e(),{map:g,layerEvent:m,self:v}=be();T(a,g,r=>n(24,o=r)),T(a,m,r=>n(23,s=r)),T(a,v,r=>n(14,t=r));function z(r){W(v,t=new he.Marker({element:r,draggable:b,offset:y}).setLngLat(l).addTo(o),t);const O=()=>M("dragstart"),j=()=>{K(),M("drag")},A=()=>{K(),M("dragend")};return b&&(t.on("dragstart",O),t.on("drag",j),t.on("dragend",A)),{destroy(){b&&(t==null||t.off("dragstart",O),t==null||t.off("drag",j),t==null||t.off("dragend",A)),t==null||t.remove()}}}function K(){let r=t==null?void 0:t.getLngLat();r&&(Array.isArray(l)?n(9,l=[r.lng,r.lat]):l&&"lon"in l?n(9,l={lon:r.lng,lat:r.lat}):n(9,l=r))}function ae(r){r.key===" "&&(r.preventDefault(),r.stopPropagation(),M("click"))}function M(r){if(!i)return;let O=t==null?void 0:t.getLngLat();if(!O)return;const j=[O.lng,O.lat];let A={map:o,marker:t,lngLat:j,features:[{type:"Feature",properties:(L==null?void 0:L.properties)??{},geometry:{type:"Point",coordinates:j}}]};W(m,s={...A,layerType:"marker",type:r},s),d(r,A)}const se=()=>M("click"),le=()=>M("dblclick"),oe=()=>M("contextmenu"),ie=r=>{M("mouseenter")},re=()=>{M("mouseleave")},ue=()=>M("mousemove");return a.$$set=r=>{"lngLat"in r&&n(9,l=r.lngLat),"class"in r&&n(0,u=r.class),"interactive"in r&&n(10,i=r.interactive),"asButton"in r&&n(1,p=r.asButton),"draggable"in r&&n(11,b=r.draggable),"feature"in r&&n(12,L=r.feature),"offset"in r&&n(13,y=r.offset),"zIndex"in r&&n(2,_=r.zIndex),"$$scope"in r&&n(15,f=r.$$scope)},a.$$.update=()=>{a.$$.dirty&16896&&(t==null||t.setLngLat(l)),a.$$.dirty&24576&&(t==null||t.setOffset(y??[0,0]))},[u,p,_,g,m,v,z,ae,M,l,i,b,L,y,t,f,c,se,le,oe,ie,re,ue]}class Oe extends ${constructor(e){super(),x(this,e,Ne,De,ee,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2})}}const je='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>';function X(a){let e,n,s,t,o,c,f,l,u,i,p,b;function L(_){a[14](_)}let y={};return a[1]!==void 0&&(y.cost=a[1]),l=new Ee({props:y}),R.push(()=>F(l,"cost",L)),{c(){e=C("div"),n=C("label"),s=H("Max requests (limit for faster updates):"),t=C("br"),o=q(),c=C("input"),f=q(),D(l.$$.fragment),E(c,"type","number"),E(c,"min",1)},m(_,d){I(_,e,d),h(e,n),h(n,s),h(n,t),h(n,o),h(n,c),Z(c,a[0]),I(_,f,d),J(l,_,d),i=!0,p||(b=B(c,"input",a[13]),p=!0)},p(_,d){d&1&&te(c.value)!==_[0]&&Z(c,_[0]);const g={};!u&&d&2&&(u=!0,g.cost=_[1],G(()=>u=!1)),l.$set(g)},i(_){i||(w(l.$$.fragment,_),i=!0)},o(_){k(l.$$.fragment,_),i=!1},d(_){_&&(S(e),S(f)),N(l,_),p=!1,b()}}}function Y(a){let e,n,s,t;return s=new Se({props:{outputMetadata:a[5].metadata,map:a[2],controls:a[7]}}),{c(){e=C("hr"),n=q(),D(s.$$.fragment)},m(o,c){I(o,e,c),I(o,n,c),J(s,o,c),t=!0},p(o,c){const f={};c&32&&(f.outputMetadata=o[5].metadata),c&4&&(f.map=o[2]),s.$set(f)},i(o){t||(w(s.$$.fragment,o),t=!0)},o(o){k(s.$$.fragment,o),t=!1},d(o){o&&(S(e),S(n)),N(s,o)}}}function Ae(a){let e,n,s,t,o,c,f,l,u,i,p,b,L,y,_;n=new ve({props:{app:"interactive"}});let d=a[3]&&X(a),g=a[5].metadata&&Y(a);return{c(){e=C("div"),D(n.$$.fragment),s=q(),t=C("label"),o=H("Open a "),c=C("i"),c.textContent=".bin",f=H(" network file or an "),l=C("i"),l.textContent=".osm.pbf",u=q(),i=C("input"),p=q(),d&&d.c(),b=q(),g&&g.c(),E(i,"type","file"),E(e,"slot","left")},m(m,v){I(m,e,v),J(n,e,null),h(e,s),h(e,t),h(t,o),h(t,c),h(t,f),h(t,l),h(t,u),h(t,i),a[12](i),h(e,p),d&&d.m(e,null),h(e,b),g&&g.m(e,null),L=!0,y||(_=B(i,"change",a[8]),y=!0)},p(m,v){m[3]?d?(d.p(m,v),v&8&&w(d,1)):(d=X(m),d.c(),w(d,1),d.m(e,b)):d&&(Q(),k(d,1,1,()=>{d=null}),V()),m[5].metadata?g?(g.p(m,v),v&32&&w(g,1)):(g=Y(m),g.c(),w(g,1),g.m(e,null)):g&&(Q(),k(g,1,1,()=>{g=null}),V())},i(m){L||(w(n.$$.fragment,m),w(d),w(g),L=!0)},o(m){k(n.$$.fragment,m),k(d),k(g),L=!1},d(m){m&&S(e),N(n),a[12](null),d&&d.d(),g&&g.d(),y=!1,_()}}}function Pe(a){let e,n;return{c(){e=new Me(!1),n=Ce(),e.a=n},m(s,t){e.m(je,s,t),I(s,n,t)},p:ne,d(s){s&&(S(n),e.d())}}}function Re(a){let e,n;return e=new qe({props:{controls:a[7]}}),{c(){D(e.$$.fragment)},m(s,t){J(e,s,t),n=!0},p:ne,i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){N(e,s)}}}function Te(a){let e,n,s,t,o;function c(l){a[10](l)}let f={draggable:!0,$$slots:{default:[Pe]},$$scope:{ctx:a}};return a[4]!==void 0&&(f.lngLat=a[4]),e=new Oe({props:f}),R.push(()=>F(e,"lngLat",c)),e.$on("dragend",a[9]),t=new Ie({props:{data:a[5],$$slots:{default:[Re]},$$scope:{ctx:a}}}),{c(){D(e.$$.fragment),s=q(),D(t.$$.fragment)},m(l,u){J(e,l,u),I(l,s,u),J(t,l,u),o=!0},p(l,u){const i={};u&32768&&(i.$$scope={dirty:u,ctx:l}),!n&&u&16&&(n=!0,i.lngLat=l[4],G(()=>n=!1)),e.$set(i);const p={};u&32&&(p.data=l[5]),u&32768&&(p.$$scope={dirty:u,ctx:l}),t.$set(p)},i(l){o||(w(e.$$.fragment,l),w(t.$$.fragment,l),o=!0)},o(l){k(e.$$.fragment,l),k(t.$$.fragment,l),o=!1},d(l){l&&S(s),N(e,l),N(t,l)}}}function He(a){let e,n,s,t;function o(f){a[11](f)}let c={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Te]},$$scope:{ctx:a}};return a[2]!==void 0&&(c.map=a[2]),n=new ye({props:c}),R.push(()=>F(n,"map",o)),{c(){e=C("div"),D(n.$$.fragment),E(e,"slot","main"),P(e,"position","relative"),P(e,"width","100%"),P(e,"height","100vh")},m(f,l){I(f,e,l),J(n,e,null),t=!0},p(f,l){const u={};l&32816&&(u.$$scope={dirty:l,ctx:f}),!s&&l&4&&(s=!0,u.map=f[2],G(()=>s=!1)),n.$set(u)},i(f){t||(w(n.$$.fragment,f),t=!0)},o(f){k(n.$$.fragment,f),t=!1},d(f){f&&S(e),N(n)}}}function Fe(a){let e,n;return e=new we({props:{$$slots:{main:[He],left:[Ae]},$$scope:{ctx:a}}}),{c(){D(e.$$.fragment)},m(s,t){J(e,s,t),n=!0},p(s,[t]){const o={};t&32895&&(o.$$scope={dirty:t,ctx:s}),e.$set(o)},i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){N(e,s)}}}function Ge(a,e,n){Le(async()=>{await ze(),await ke()});let s,t,o={lng:0,lat:0},c={type:"FeatureCollection",features:[]},f=1e3,l="Distance",u={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},i;async function p(m){try{let v=await i.files[0].arrayBuffer();n(3,t=new Be(new Uint8Array(v)));let z=t.getBounds();s.fitBounds([[z[0],z[1]],[z[2],z[3]]],{padding:20,animate:!1}),n(4,o.lng=(z[0]+z[2])/2,o),n(4,o.lat=(z[1]+z[3])/2,o),b()}catch(v){window.alert(`Problem loading network file: ${v}`)}}function b(){t&&n(5,c=JSON.parse(t.recalculate({lng:o.lng,lat:o.lat,max_requests:f,cost:l})))}function L(m){o=m,n(4,o)}function y(m){s=m,n(2,s)}function _(m){R[m?"unshift":"push"](()=>{i=m,n(6,i)})}function d(){f=te(this.value),n(0,f)}function g(m){l=m,n(1,l)}return a.$$.update=()=>{a.$$.dirty&3&&b()},[f,l,s,t,o,c,i,u,p,b,L,y,_,d,g]}class Ke extends ${constructor(e){super(),x(this,e,Ge,Fe,ee,{})}}new Ke({target:document.getElementById("app")});
