import{S as oe,i as re,s as ie,G as ue,e as S,h as A,z as U,l as J,I as $,q as j,J as pe,K as ce,N as de,O as me,t as L,b as C,v as N,w as ge,Q as _e,R as be,T as Y,U as x,m as he,L as we,c as O,f as I,a as D,d as q,o as Le,H as ve,x as X,y as W,g as V,n as v,A as Q,r as ee,u as te,M as ye,_ as ke,V as fe,W as Ce,j as ne,D as Me,E as Be,X as ze}from"./Legend-fb6fd039.js";import{L as Ee,C as Se,O as Ie,_ as Oe,J as De,a as qe,G as Je}from"./OverpassSelector-59562d92.js";import{S as Ne,L as Pe}from"./SidebarControls-cac3e760.js";function je(s){let e,t,l,n,o,f,p;const a=s[16].default,i=ue(a,s,s[15],null);return{c(){e=S("div"),i&&i.c(),A(e,"tabindex",t=s[1]?0:void 0),A(e,"role",l=s[1]?"button":void 0),U(e,"z-index",s[2])},m(r,g){J(r,e,g),i&&i.m(e,null),o=!0,f||(p=[$(s[6].call(null,e)),$(n=Ae.call(null,e,s[0])),j(e,"click",s[17]),j(e,"dblclick",s[18]),j(e,"contextmenu",s[19]),j(e,"mouseenter",s[20]),j(e,"mouseleave",s[21]),j(e,"mousemove",s[22]),j(e,"keydown",s[7])],f=!0)},p(r,[g]){i&&i.p&&(!o||g&32768)&&pe(i,a,r,r[15],o?de(a,r[15],g,null):ce(r[15]),null),(!o||g&2&&t!==(t=r[1]?0:void 0))&&A(e,"tabindex",t),(!o||g&2&&l!==(l=r[1]?"button":void 0))&&A(e,"role",l),n&&me(n.update)&&g&1&&n.update.call(null,r[0]),g&4&&U(e,"z-index",r[2])},i(r){o||(L(i,r),o=!0)},o(r){C(i,r),o=!1},d(r){r&&N(e),i&&i.d(r),f=!1,ge(p)}}}function Ae(s,e){const t=s.className;function l(n){n?s.className=`${t} ${n}`:s.className=t}return l(e),{update:l}}function Re(s,e,t){let l,n,o,{$$slots:f={},$$scope:p}=e,{lngLat:a}=e,{class:i=void 0}=e,{interactive:r=!0}=e,{asButton:g=!1}=e,{draggable:y=!1}=e,{feature:h=null}=e,{offset:z=void 0}=e,{zIndex:_=void 0}=e;const k=_e(),{map:M,layerEvent:P,self:R}=be();Y(s,M,u=>t(24,o=u)),Y(s,P,u=>t(23,l=u)),Y(s,R,u=>t(14,n=u));function Z(u){x(R,n=new he.Marker({element:u,draggable:y,offset:z}).setLngLat(a).addTo(o),n);const G=()=>c("dragstart"),H=()=>{T(),c("drag")},K=()=>{T(),c("dragend")};return y&&(n.on("dragstart",G),n.on("drag",H),n.on("dragend",K)),{destroy(){y&&(n==null||n.off("dragstart",G),n==null||n.off("drag",H),n==null||n.off("dragend",K)),n==null||n.remove()}}}function T(){let u=n==null?void 0:n.getLngLat();u&&(Array.isArray(a)?t(9,a=[u.lng,u.lat]):a&&"lon"in a?t(9,a={lon:u.lng,lat:u.lat}):t(9,a=u))}function w(u){u.key===" "&&(u.preventDefault(),u.stopPropagation(),c("click"))}function c(u){if(!r)return;let G=n==null?void 0:n.getLngLat();if(!G)return;const H=[G.lng,G.lat];let K={map:o,marker:n,lngLat:H,features:[{type:"Feature",properties:(h==null?void 0:h.properties)??{},geometry:{type:"Point",coordinates:H}}]};x(P,l={...K,layerType:"marker",type:u},l),k(u,K)}const b=()=>c("click"),d=()=>c("dblclick"),E=()=>c("contextmenu"),F=u=>{c("mouseenter")},m=()=>{c("mouseleave")},B=()=>c("mousemove");return s.$$set=u=>{"lngLat"in u&&t(9,a=u.lngLat),"class"in u&&t(0,i=u.class),"interactive"in u&&t(10,r=u.interactive),"asButton"in u&&t(1,g=u.asButton),"draggable"in u&&t(11,y=u.draggable),"feature"in u&&t(12,h=u.feature),"offset"in u&&t(13,z=u.offset),"zIndex"in u&&t(2,_=u.zIndex),"$$scope"in u&&t(15,p=u.$$scope)},s.$$.update=()=>{s.$$.dirty&16896&&(n==null||n.setLngLat(a)),s.$$.dirty&24576&&(n==null||n.setOffset(z??[0,0]))},[i,g,_,M,P,R,Z,w,c,a,r,y,h,z,n,p,f,b,d,E,F,m,B]}class Te extends oe{constructor(e){super(),re(this,e,Re,je,ie,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2})}}const Fe=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function se(s){let e,t;return{c(){e=S("p"),t=V(s[10])},m(l,n){J(l,e,n),v(e,t)},p(l,n){n&1024&&Ce(t,l[10])},d(l){l&&N(e)}}}function ae(s){let e,t,l,n,o,f,p,a,i,r,g,y;function h(_){s[21](_)}let z={};return s[2]!==void 0&&(z.cost=s[2]),a=new qe({props:z}),X.push(()=>W(a,"cost",h)),{c(){e=S("div"),t=S("label"),l=V("Max requests (limit for faster updates):"),n=S("br"),o=I(),f=S("input"),p=I(),O(a.$$.fragment),A(f,"type","number"),A(f,"min",1)},m(_,k){J(_,e,k),v(e,t),v(t,l),v(t,n),v(t,o),v(t,f),ne(f,s[1]),J(_,p,k),D(a,_,k),r=!0,g||(y=j(f,"input",s[20]),g=!0)},p(_,k){k&2&&fe(f.value)!==_[1]&&ne(f,_[1]);const M={};!i&&k&4&&(i=!0,M.cost=_[2],Q(()=>i=!1)),a.$set(M)},i(_){r||(L(a.$$.fragment,_),r=!0)},o(_){C(a.$$.fragment,_),r=!1},d(_){_&&(N(e),N(p)),q(a,_),g=!1,y()}}}function le(s){let e,t,l,n,o;function f(a){s[22](a)}let p={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(p.controls=s[8]),l=new Ne({props:p}),X.push(()=>W(l,"controls",f)),{c(){e=S("hr"),t=I(),O(l.$$.fragment)},m(a,i){J(a,e,i),J(a,t,i),D(l,a,i),o=!0},p(a,i){const r={};i&64&&(r.outputMetadata=a[6].metadata),i&8&&(r.map=a[3]),!n&&i&256&&(n=!0,r.controls=a[8],Q(()=>n=!1)),l.$set(r)},i(a){o||(L(l.$$.fragment,a),o=!0)},o(a){C(l.$$.fragment,a),o=!1},d(a){a&&(N(e),N(t)),q(l,a)}}}function Ge(s){let e,t,l,n,o,f,p,a,i,r,g,y,h,z,_,k,M,P,R;t=new ve({props:{app:"interactive"}});function Z(d){s[17](d)}let T={};s[0]!==void 0&&(T.example=s[0]),r=new Se({props:T}),X.push(()=>W(r,"example",Z)),h=new Ie({props:{map:s[3]}}),h.$on("gotXml",s[13]),h.$on("loading",s[18]),h.$on("error",s[19]);let w=s[10]&&se(s),c=s[4]&&ae(s),b=s[6].metadata&&le(s);return{c(){e=S("div"),O(t.$$.fragment),l=I(),n=S("label"),o=V("Open an "),f=S("i"),f.textContent=".osm.pbf",p=V(` file
      `),a=S("input"),i=I(),O(r.$$.fragment),y=I(),O(h.$$.fragment),z=I(),w&&w.c(),_=I(),c&&c.c(),k=I(),b&&b.c(),A(a,"type","file"),A(e,"slot","left")},m(d,E){J(d,e,E),D(t,e,null),v(e,l),v(e,n),v(n,o),v(n,f),v(n,p),v(n,a),s[16](a),v(e,i),D(r,e,null),v(e,y),D(h,e,null),v(e,z),w&&w.m(e,null),v(e,_),c&&c.m(e,null),v(e,k),b&&b.m(e,null),M=!0,P||(R=j(a,"change",s[11]),P=!0)},p(d,E){const F={};!g&&E&1&&(g=!0,F.example=d[0],Q(()=>g=!1)),r.$set(F);const m={};E&8&&(m.map=d[3]),h.$set(m),d[10]?w?w.p(d,E):(w=se(d),w.c(),w.m(e,_)):w&&(w.d(1),w=null),d[4]?c?(c.p(d,E),E&16&&L(c,1)):(c=ae(d),c.c(),L(c,1),c.m(e,k)):c&&(ee(),C(c,1,1,()=>{c=null}),te()),d[6].metadata?b?(b.p(d,E),E&64&&L(b,1)):(b=le(d),b.c(),L(b,1),b.m(e,null)):b&&(ee(),C(b,1,1,()=>{b=null}),te())},i(d){M||(L(t.$$.fragment,d),L(r.$$.fragment,d),L(h.$$.fragment,d),L(c),L(b),M=!0)},o(d){C(t.$$.fragment,d),C(r.$$.fragment,d),C(h.$$.fragment,d),C(c),C(b),M=!1},d(d){d&&N(e),q(t),s[16](null),q(r),q(h),w&&w.d(),c&&c.d(),b&&b.d(),P=!1,R()}}}function Xe(s){let e,t;return{c(){e=new ze(!1),t=Me(),e.a=t},m(l,n){e.m(Fe,l,n),J(l,t,n)},p:Be,d(l){l&&(N(t),e.d())}}}function Ze(s){let e,t;return e=new Pe({props:{controls:s[8]}}),{c(){O(e.$$.fragment)},m(l,n){D(e,l,n),t=!0},p(l,n){const o={};n&256&&(o.controls=l[8]),e.$set(o)},i(l){t||(L(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){q(e,l)}}}function He(s){let e,t,l,n,o;function f(a){s[14](a)}let p={draggable:!0,$$slots:{default:[Xe]},$$scope:{ctx:s}};return s[5]!==void 0&&(p.lngLat=s[5]),e=new Te({props:p}),X.push(()=>W(e,"lngLat",f)),e.$on("dragend",s[12]),n=new Je({props:{data:s[6],$$slots:{default:[Ze]},$$scope:{ctx:s}}}),{c(){O(e.$$.fragment),l=I(),O(n.$$.fragment)},m(a,i){D(e,a,i),J(a,l,i),D(n,a,i),o=!0},p(a,i){const r={};i&33554432&&(r.$$scope={dirty:i,ctx:a}),!t&&i&32&&(t=!0,r.lngLat=a[5],Q(()=>t=!1)),e.$set(r);const g={};i&64&&(g.data=a[6]),i&33554688&&(g.$$scope={dirty:i,ctx:a}),n.$set(g)},i(a){o||(L(e.$$.fragment,a),L(n.$$.fragment,a),o=!0)},o(a){C(e.$$.fragment,a),C(n.$$.fragment,a),o=!1},d(a){a&&N(l),q(e,a),q(n,a)}}}function Ke(s){let e,t,l,n;function o(p){s[15](p)}let f={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[He]},$$scope:{ctx:s}};return s[3]!==void 0&&(f.map=s[3]),t=new ye({props:f}),X.push(()=>W(t,"map",o)),{c(){e=S("div"),O(t.$$.fragment),A(e,"slot","main"),U(e,"position","relative"),U(e,"width","100%"),U(e,"height","100vh")},m(p,a){J(p,e,a),D(t,e,null),n=!0},p(p,a){const i={};a&33554784&&(i.$$scope={dirty:a,ctx:p}),!l&&a&8&&(l=!0,i.map=p[3],Q(()=>l=!1)),t.$set(i)},i(p){n||(L(t.$$.fragment,p),n=!0)},o(p){C(t.$$.fragment,p),n=!1},d(p){p&&N(e),q(t)}}}function Ue(s){let e,t,l,n;return e=new we({props:{$$slots:{main:[Ke],left:[Ge]},$$scope:{ctx:s}}}),l=new Ee({props:{loading:s[7]}}),{c(){O(e.$$.fragment),t=I(),O(l.$$.fragment)},m(o,f){D(e,o,f),J(o,t,f),D(l,o,f),n=!0},p(o,[f]){const p={};f&33556351&&(p.$$scope={dirty:f,ctx:o}),e.$set(p);const a={};f&128&&(a.loading=o[7]),l.$set(a)},i(o){n||(L(e.$$.fragment,o),L(l.$$.fragment,o),n=!0)},o(o){C(e.$$.fragment,o),C(l.$$.fragment,o),n=!1},d(o){o&&N(t),q(e,o),q(l,o)}}}function We(s,e,t){Le(async()=>{await Oe(),await ke()});let l,n,o="",f={lng:0,lat:0},p={type:"FeatureCollection",features:[]},a=!1,i=1e3,r="Distance",g={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function h(m){t(0,o=""),t(7,a=!0),z(await y.files[0].arrayBuffer())}function z(m){try{t(4,n=new De(new Uint8Array(m))),t(2,r="Distance");let B=n.getBounds();l.fitBounds([[B[0],B[1]],[B[2],B[3]]],{padding:20,animate:!1}),t(5,f.lng=(B[0]+B[2])/2,f),t(5,f.lat=(B[1]+B[3])/2,f),k()}catch(B){window.alert(`Problem importing osm.pbf file: ${B}`)}t(7,a=!1)}async function _(m){if(m!=""){t(7,a=!0);let B=await fetch(`https://assets.od2net.org/pbf_clips/${m}.osm.pbf`);z(await B.arrayBuffer())}}function k(){n&&t(6,p=JSON.parse(n.recalculate({lng:f.lng,lat:f.lat,max_requests:i,cost:r})))}let M="";function P(m){t(10,M="Got XML, see console"),console.log(m.detail)}function R(m){f=m,t(5,f)}function Z(m){l=m,t(3,l)}function T(m){X[m?"unshift":"push"](()=>{y=m,t(9,y)})}function w(m){o=m,t(0,o)}const c=m=>t(10,M=m.detail),b=m=>t(10,M=m.detail);function d(){i=fe(this.value),t(1,i)}function E(m){r=m,t(2,r)}function F(m){g=m,t(8,g)}return s.$$.update=()=>{s.$$.dirty&1&&_(o),s.$$.dirty&6&&k()},[o,i,r,l,n,f,p,a,g,y,M,h,k,P,R,Z,T,w,c,b,d,E,F]}class Qe extends oe{constructor(e){super(),re(this,e,We,Ue,ie,{})}}new Qe({target:document.getElementById("app")});
