import{S as K,i as U,s as Z,G as ge,e as y,h as z,z as R,l as k,I as Y,q as H,J as be,K as he,N as ye,O as we,t as w,b as M,v as L,w as ve,Q as ke,R as Le,T as W,U as $,m as Ce,g as j,f as T,D as re,j as A,k as Me,n as h,p as x,E as P,V as ee,W as ze,X as Oe,Y as F,C as He,Z as Se,L as Te,c as B,a as D,d as E,o as Be,H as De,r as te,u as ne,M as Ee,x as G,y as Q,A as V,_ as Ie,$ as Ae}from"./Layout-e9bd37ce.js";import{_ as Ne,J as qe,G as Je}from"./@vite-plugin-wasm-pack@wasm-od2net-06f26cd5.js";import{g as Re,S as je,L as Pe}from"./SidebarControls-8b5318b5.js";function Fe(a){let e,t,l,n,o,i,r;const s=a[16].default,u=ge(s,a,a[15],null);return{c(){e=y("div"),u&&u.c(),z(e,"tabindex",t=a[1]?0:void 0),z(e,"role",l=a[1]?"button":void 0),R(e,"z-index",a[2])},m(f,p){k(f,e,p),u&&u.m(e,null),o=!0,i||(r=[Y(a[6].call(null,e)),Y(n=Ge.call(null,e,a[0])),H(e,"click",a[17]),H(e,"dblclick",a[18]),H(e,"contextmenu",a[19]),H(e,"mouseenter",a[20]),H(e,"mouseleave",a[21]),H(e,"mousemove",a[22]),H(e,"keydown",a[7])],i=!0)},p(f,[p]){u&&u.p&&(!o||p&32768)&&be(u,s,f,f[15],o?ye(s,f[15],p,null):he(f[15]),null),(!o||p&2&&t!==(t=f[1]?0:void 0))&&z(e,"tabindex",t),(!o||p&2&&l!==(l=f[1]?"button":void 0))&&z(e,"role",l),n&&we(n.update)&&p&1&&n.update.call(null,f[0]),p&4&&R(e,"z-index",f[2])},i(f){o||(w(u,f),o=!0)},o(f){M(u,f),o=!1},d(f){f&&L(e),u&&u.d(f),i=!1,ve(r)}}}function Ge(a,e){const t=a.className;function l(n){n?a.className=`${t} ${n}`:a.className=t}return l(e),{update:l}}function We(a,e,t){let l,n,o,{$$slots:i={},$$scope:r}=e,{lngLat:s}=e,{class:u=void 0}=e,{interactive:f=!0}=e,{asButton:p=!1}=e,{draggable:d=!1}=e,{feature:g=null}=e,{offset:m=void 0}=e,{zIndex:_=void 0}=e;const b=ke(),{map:v,layerEvent:C,self:I}=Le();W(a,v,c=>t(24,o=c)),W(a,C,c=>t(23,l=c)),W(a,I,c=>t(14,n=c));function S(c){$(I,n=new Ce.Marker({element:c,draggable:d,offset:m}).setLngLat(s).addTo(o),n);const N=()=>O("dragstart"),q=()=>{X(),O("drag")},J=()=>{X(),O("dragend")};return d&&(n.on("dragstart",N),n.on("drag",q),n.on("dragend",J)),{destroy(){d&&(n==null||n.off("dragstart",N),n==null||n.off("drag",q),n==null||n.off("dragend",J)),n==null||n.remove()}}}function X(){let c=n==null?void 0:n.getLngLat();c&&(Array.isArray(s)?t(9,s=[c.lng,c.lat]):s&&"lon"in s?t(9,s={lon:c.lng,lat:c.lat}):t(9,s=c))}function ue(c){c.key===" "&&(c.preventDefault(),c.stopPropagation(),O("click"))}function O(c){if(!f)return;let N=n==null?void 0:n.getLngLat();if(!N)return;const q=[N.lng,N.lat];let J={map:o,marker:n,lngLat:q,features:[{type:"Feature",properties:(g==null?void 0:g.properties)??{},geometry:{type:"Point",coordinates:q}}]};$(C,l={...J,layerType:"marker",type:c},l),b(c,J)}const fe=()=>O("click"),ce=()=>O("dblclick"),_e=()=>O("contextmenu"),de=c=>{O("mouseenter")},me=()=>{O("mouseleave")},pe=()=>O("mousemove");return a.$$set=c=>{"lngLat"in c&&t(9,s=c.lngLat),"class"in c&&t(0,u=c.class),"interactive"in c&&t(10,f=c.interactive),"asButton"in c&&t(1,p=c.asButton),"draggable"in c&&t(11,d=c.draggable),"feature"in c&&t(12,g=c.feature),"offset"in c&&t(13,m=c.offset),"zIndex"in c&&t(2,_=c.zIndex),"$$scope"in c&&t(15,r=c.$$scope)},a.$$.update=()=>{a.$$.dirty&16896&&(n==null||n.setLngLat(s)),a.$$.dirty&24576&&(n==null||n.setOffset(m??[0,0]))},[u,p,_,v,C,I,S,ue,O,s,f,d,g,m,n,r,i,fe,ce,_e,de,me,pe]}class Ke extends K{constructor(e){super(),U(this,e,We,Fe,Z,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2})}}const Ue='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',{Map:Ze}=Re;function ae(a,e,t){const l=a.slice();return l[6]=e[t][0],l[7]=e[t][1],l[8]=e,l[9]=t,l}function le(a){let e,t=[],l=new Ze,n=ee(a[1].entries());const o=i=>i[6];for(let i=0;i<n.length;i+=1){let r=ae(a,n,i),s=o(r);l.set(s,t[i]=se(s,r))}return{c(){e=y("ul");for(let i=0;i<t.length;i+=1)t[i].c()},m(i,r){k(i,e,r);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(i,r){r&2&&(n=ee(i[1].entries()),t=ze(t,r,o,1,i,n,l,e,Se,se,null,ae))},d(i){i&&L(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function se(a,e){let t,l,n=e[6]+"",o,i,r,s,u;function f(){e[4].call(i,e[8],e[9])}return{key:a,first:null,c(){t=y("li"),l=y("label"),o=j(n),i=y("input"),r=T(),z(i,"type","number"),z(i,"min","1.0"),z(i,"step","0.1"),this.first=t},m(p,d){k(p,t,d),h(t,l),h(l,o),h(l,i),A(i,e[7]),h(t,r),s||(u=H(i,"input",f),s=!0)},p(p,d){e=p,d&2&&n!==(n=e[6]+"")&&Oe(o,n),d&2&&F(i.value)!==e[7]&&A(i,e[7])},d(p){p&&L(t),s=!1,u()}}}function Qe(a){let e,t,l,n,o,i,r,s,u,f,p,d=a[0]=="OsmHighwayType"&&le(a);return{c(){e=y("div"),t=y("label"),l=j(`Cost function:
    `),n=y("select"),o=y("option"),o.textContent="Distance",i=y("option"),i.textContent="Avoid main roads",r=y("option"),r.textContent="Set a weight per OSM highway type",s=T(),d&&d.c(),u=re(),o.__value="Distance",A(o,o.__value),i.__value="AvoidMainRoads",A(i,i.__value),r.__value="OsmHighwayType",A(r,r.__value),a[0]===void 0&&Me(()=>a[3].call(n))},m(g,m){k(g,e,m),h(e,t),h(t,l),h(t,n),h(n,o),h(n,i),h(n,r),x(n,a[0],!0),k(g,s,m),d&&d.m(g,m),k(g,u,m),f||(p=H(n,"change",a[3]),f=!0)},p(g,[m]){m&1&&x(n,g[0]),g[0]=="OsmHighwayType"?d?d.p(g,m):(d=le(g),d.c(),d.m(u.parentNode,u)):d&&(d.d(1),d=null)},i:P,o:P,d(g){g&&(L(e),L(s),L(u)),d&&d.d(g),f=!1,p()}}}function Ve(a,e,t){let{cost:l}=e,n="Distance",o=new Map(["cycleway","footway","living_street","motorway","motorway_link","path","pedestrian","primary","primary_link","residential","secondary","secondary_link","service","steps","tertiary","tertiary_link","track","trunk","trunk_link","unclassified"].map(u=>[u,1]));function i(u){u=="OsmHighwayType"?t(2,l={OsmHighwayType:o}):t(2,l=u)}function r(){n=He(this),t(0,n)}function s(u,f){u[f][1]=F(this.value),t(1,o)}return a.$$set=u=>{"cost"in u&&t(2,l=u.cost)},a.$$.update=()=>{a.$$.dirty&1&&i(n)},[n,o,l,r,s]}class Xe extends K{constructor(e){super(),U(this,e,Ve,Qe,Z,{cost:2})}}function ie(a){let e,t,l,n,o,i,r,s,u,f,p,d;function g(_){a[14](_)}let m={};return a[1]!==void 0&&(m.cost=a[1]),s=new Xe({props:m}),G.push(()=>Q(s,"cost",g)),{c(){e=y("div"),t=y("label"),l=j("Max requests (limit for faster updates):"),n=y("br"),o=T(),i=y("input"),r=T(),B(s.$$.fragment),z(i,"type","number"),z(i,"min",1)},m(_,b){k(_,e,b),h(e,t),h(t,l),h(t,n),h(t,o),h(t,i),A(i,a[0]),k(_,r,b),D(s,_,b),f=!0,p||(d=H(i,"input",a[13]),p=!0)},p(_,b){b&1&&F(i.value)!==_[0]&&A(i,_[0]);const v={};!u&&b&2&&(u=!0,v.cost=_[1],V(()=>u=!1)),s.$set(v)},i(_){f||(w(s.$$.fragment,_),f=!0)},o(_){M(s.$$.fragment,_),f=!1},d(_){_&&(L(e),L(r)),E(s,_),p=!1,d()}}}function oe(a){let e,t,l,n;return l=new je({props:{outputMetadata:a[5].metadata,map:a[2],controls:a[7]}}),{c(){e=y("hr"),t=T(),B(l.$$.fragment)},m(o,i){k(o,e,i),k(o,t,i),D(l,o,i),n=!0},p(o,i){const r={};i&32&&(r.outputMetadata=o[5].metadata),i&4&&(r.map=o[2]),l.$set(r)},i(o){n||(w(l.$$.fragment,o),n=!0)},o(o){M(l.$$.fragment,o),n=!1},d(o){o&&(L(e),L(t)),E(l,o)}}}function Ye(a){let e,t,l,n,o,i,r,s,u,f,p,d,g;t=new De({props:{app:"interactive"}});let m=a[3]&&ie(a),_=a[5].metadata&&oe(a);return{c(){e=y("div"),B(t.$$.fragment),l=T(),n=y("label"),o=j("Open a "),i=y("i"),i.textContent=".bin",r=j(` network file
      `),s=y("input"),u=T(),m&&m.c(),f=T(),_&&_.c(),z(s,"type","file"),z(e,"slot","left")},m(b,v){k(b,e,v),D(t,e,null),h(e,l),h(e,n),h(n,o),h(n,i),h(n,r),h(n,s),a[12](s),h(e,u),m&&m.m(e,null),h(e,f),_&&_.m(e,null),p=!0,d||(g=H(s,"change",a[8]),d=!0)},p(b,v){b[3]?m?(m.p(b,v),v&8&&w(m,1)):(m=ie(b),m.c(),w(m,1),m.m(e,f)):m&&(te(),M(m,1,1,()=>{m=null}),ne()),b[5].metadata?_?(_.p(b,v),v&32&&w(_,1)):(_=oe(b),_.c(),w(_,1),_.m(e,null)):_&&(te(),M(_,1,1,()=>{_=null}),ne())},i(b){p||(w(t.$$.fragment,b),w(m),w(_),p=!0)},o(b){M(t.$$.fragment,b),M(m),M(_),p=!1},d(b){b&&L(e),E(t),a[12](null),m&&m.d(),_&&_.d(),d=!1,g()}}}function $e(a){let e,t;return{c(){e=new Ae(!1),t=re(),e.a=t},m(l,n){e.m(Ue,l,n),k(l,t,n)},p:P,d(l){l&&(L(t),e.d())}}}function xe(a){let e,t;return e=new Pe({props:{controls:a[7]}}),{c(){B(e.$$.fragment)},m(l,n){D(e,l,n),t=!0},p:P,i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){E(e,l)}}}function et(a){let e,t,l,n,o;function i(s){a[10](s)}let r={draggable:!0,$$slots:{default:[$e]},$$scope:{ctx:a}};return a[4]!==void 0&&(r.lngLat=a[4]),e=new Ke({props:r}),G.push(()=>Q(e,"lngLat",i)),e.$on("dragend",a[9]),n=new Je({props:{data:a[5],$$slots:{default:[xe]},$$scope:{ctx:a}}}),{c(){B(e.$$.fragment),l=T(),B(n.$$.fragment)},m(s,u){D(e,s,u),k(s,l,u),D(n,s,u),o=!0},p(s,u){const f={};u&32768&&(f.$$scope={dirty:u,ctx:s}),!t&&u&16&&(t=!0,f.lngLat=s[4],V(()=>t=!1)),e.$set(f);const p={};u&32&&(p.data=s[5]),u&32768&&(p.$$scope={dirty:u,ctx:s}),n.$set(p)},i(s){o||(w(e.$$.fragment,s),w(n.$$.fragment,s),o=!0)},o(s){M(e.$$.fragment,s),M(n.$$.fragment,s),o=!1},d(s){s&&L(l),E(e,s),E(n,s)}}}function tt(a){let e,t,l,n;function o(r){a[11](r)}let i={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[et]},$$scope:{ctx:a}};return a[2]!==void 0&&(i.map=a[2]),t=new Ee({props:i}),G.push(()=>Q(t,"map",o)),{c(){e=y("div"),B(t.$$.fragment),z(e,"slot","main"),R(e,"position","relative"),R(e,"width","100%"),R(e,"height","100vh")},m(r,s){k(r,e,s),D(t,e,null),n=!0},p(r,s){const u={};s&32816&&(u.$$scope={dirty:s,ctx:r}),!l&&s&4&&(l=!0,u.map=r[2],V(()=>l=!1)),t.$set(u)},i(r){n||(w(t.$$.fragment,r),n=!0)},o(r){M(t.$$.fragment,r),n=!1},d(r){r&&L(e),E(t)}}}function nt(a){let e,t;return e=new Te({props:{$$slots:{main:[tt],left:[Ye]},$$scope:{ctx:a}}}),{c(){B(e.$$.fragment)},m(l,n){D(e,l,n),t=!0},p(l,[n]){const o={};n&32895&&(o.$$scope={dirty:n,ctx:l}),e.$set(o)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){E(e,l)}}}function at(a,e,t){Be(async()=>{await Ne(),await Ie()});let l,n,o={lng:0,lat:0},i={type:"FeatureCollection",features:[]},r=1e3,s="Distance",u={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},f;async function p(C){try{let I=await f.files[0].arrayBuffer();t(3,n=new qe(new Uint8Array(I)));let S=n.getBounds();l.fitBounds([[S[0],S[1]],[S[2],S[3]]],{padding:20,animate:!1}),t(4,o.lng=(S[0]+S[2])/2,o),t(4,o.lat=(S[1]+S[3])/2,o),d()}catch(I){window.alert(`Problem loading network file: ${I}`)}}function d(){n&&t(5,i=JSON.parse(n.recalculate({lng:o.lng,lat:o.lat,max_requests:r,cost:s})))}function g(C){o=C,t(4,o)}function m(C){l=C,t(2,l)}function _(C){G[C?"unshift":"push"](()=>{f=C,t(6,f)})}function b(){r=F(this.value),t(0,r)}function v(C){s=C,t(1,s)}return a.$$.update=()=>{a.$$.dirty&3&&d()},[r,s,l,n,o,i,f,u,p,d,g,m,_,b,v]}class lt extends K{constructor(e){super(),U(this,e,at,nt,Z,{})}}new lt({target:document.getElementById("app")});
