import{S as oe,i as re,s as ie,G as ue,e as S,h as R,z as K,l as P,I as $,q as N,J as pe,K as ce,N as de,O as me,t as L,b as C,v as J,w as ge,Q as _e,R as be,T as Y,U as x,m as he,L as we,c as O,f as I,a as q,d as D,o as Le,H as ve,x as Z,y as W,g as V,n as v,A as Q,r as ee,u as te,M as ye,_ as ke,V as fe,W as Ce,j as ne,D as Me,E as Be,X as Ee}from"./Legend-71b0f321.js";import{L as ze,C as Se,O as Ie,_ as Oe,J as qe,a as De,G as Pe}from"./OverpassSelector-a09efabf.js";import{S as Je,L as Ne}from"./SidebarControls-de35fcb0.js";function Re(s){let e,t,l,n,o,u,p;const a=s[16].default,f=ue(a,s,s[15],null);return{c(){e=S("div"),f&&f.c(),R(e,"tabindex",t=s[1]?0:void 0),R(e,"role",l=s[1]?"button":void 0),K(e,"z-index",s[2])},m(i,m){P(i,e,m),f&&f.m(e,null),o=!0,u||(p=[$(s[6].call(null,e)),$(n=Te.call(null,e,s[0])),N(e,"click",s[17]),N(e,"dblclick",s[18]),N(e,"contextmenu",s[19]),N(e,"mouseenter",s[20]),N(e,"mouseleave",s[21]),N(e,"mousemove",s[22]),N(e,"keydown",s[7])],u=!0)},p(i,[m]){f&&f.p&&(!o||m&32768)&&pe(f,a,i,i[15],o?de(a,i[15],m,null):ce(i[15]),null),(!o||m&2&&t!==(t=i[1]?0:void 0))&&R(e,"tabindex",t),(!o||m&2&&l!==(l=i[1]?"button":void 0))&&R(e,"role",l),n&&me(n.update)&&m&1&&n.update.call(null,i[0]),m&4&&K(e,"z-index",i[2])},i(i){o||(L(f,i),o=!0)},o(i){C(f,i),o=!1},d(i){i&&J(e),f&&f.d(i),u=!1,ge(p)}}}function Te(s,e){const t=s.className;function l(n){n?s.className=`${t} ${n}`:s.className=t}return l(e),{update:l}}function je(s,e,t){let l,n,o,{$$slots:u={},$$scope:p}=e,{lngLat:a}=e,{class:f=void 0}=e,{interactive:i=!0}=e,{asButton:m=!1}=e,{draggable:y=!1}=e,{feature:h=null}=e,{offset:M=void 0}=e,{zIndex:_=void 0}=e;const k=_e(),{map:z,layerEvent:B,self:T}=be();Y(s,z,r=>t(24,o=r)),Y(s,B,r=>t(23,l=r)),Y(s,T,r=>t(14,n=r));function G(r){x(T,n=new he.Marker({element:r,draggable:y,offset:M}).setLngLat(a).addTo(o),n);const X=()=>c("dragstart"),H=()=>{j(),c("drag")},U=()=>{j(),c("dragend")};return y&&(n.on("dragstart",X),n.on("drag",H),n.on("dragend",U)),{destroy(){y&&(n==null||n.off("dragstart",X),n==null||n.off("drag",H),n==null||n.off("dragend",U)),n==null||n.remove()}}}function j(){let r=n==null?void 0:n.getLngLat();r&&(Array.isArray(a)?t(9,a=[r.lng,r.lat]):a&&"lon"in a?t(9,a={lon:r.lng,lat:r.lat}):t(9,a=r))}function w(r){r.key===" "&&(r.preventDefault(),r.stopPropagation(),c("click"))}function c(r){if(!i)return;let X=n==null?void 0:n.getLngLat();if(!X)return;const H=[X.lng,X.lat];let U={map:o,marker:n,lngLat:H,features:[{type:"Feature",properties:(h==null?void 0:h.properties)??{},geometry:{type:"Point",coordinates:H}}]};x(B,l={...U,layerType:"marker",type:r},l),k(r,U)}const b=()=>c("click"),d=()=>c("dblclick"),E=()=>c("contextmenu"),A=r=>{c("mouseenter")},F=()=>{c("mouseleave")},g=()=>c("mousemove");return s.$$set=r=>{"lngLat"in r&&t(9,a=r.lngLat),"class"in r&&t(0,f=r.class),"interactive"in r&&t(10,i=r.interactive),"asButton"in r&&t(1,m=r.asButton),"draggable"in r&&t(11,y=r.draggable),"feature"in r&&t(12,h=r.feature),"offset"in r&&t(13,M=r.offset),"zIndex"in r&&t(2,_=r.zIndex),"$$scope"in r&&t(15,p=r.$$scope)},s.$$.update=()=>{s.$$.dirty&16896&&(n==null||n.setLngLat(a)),s.$$.dirty&24576&&(n==null||n.setOffset(M??[0,0]))},[f,m,_,z,B,T,G,w,c,a,i,y,h,M,n,p,u,b,d,E,A,F,g]}class Ae extends oe{constructor(e){super(),re(this,e,je,Re,ie,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2})}}const Fe=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function se(s){let e,t;return{c(){e=S("p"),t=V(s[10])},m(l,n){P(l,e,n),v(e,t)},p(l,n){n&1024&&Ce(t,l[10])},d(l){l&&J(e)}}}function ae(s){let e,t,l,n,o,u,p,a,f,i,m,y;function h(_){s[21](_)}let M={};return s[2]!==void 0&&(M.cost=s[2]),a=new De({props:M}),Z.push(()=>W(a,"cost",h)),{c(){e=S("div"),t=S("label"),l=V(`Max requests (limit for faster updates):
          `),n=S("br"),o=I(),u=S("input"),p=I(),O(a.$$.fragment),R(u,"type","number"),R(u,"min",1)},m(_,k){P(_,e,k),v(e,t),v(t,l),v(t,n),v(t,o),v(t,u),ne(u,s[1]),P(_,p,k),q(a,_,k),i=!0,m||(y=N(u,"input",s[20]),m=!0)},p(_,k){k&2&&fe(u.value)!==_[1]&&ne(u,_[1]);const z={};!f&&k&4&&(f=!0,z.cost=_[2],Q(()=>f=!1)),a.$set(z)},i(_){i||(L(a.$$.fragment,_),i=!0)},o(_){C(a.$$.fragment,_),i=!1},d(_){_&&(J(e),J(p)),D(a,_),m=!1,y()}}}function le(s){let e,t,l,n,o;function u(a){s[22](a)}let p={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(p.controls=s[8]),l=new Je({props:p}),Z.push(()=>W(l,"controls",u)),{c(){e=S("hr"),t=I(),O(l.$$.fragment)},m(a,f){P(a,e,f),P(a,t,f),q(l,a,f),o=!0},p(a,f){const i={};f&64&&(i.outputMetadata=a[6].metadata),f&8&&(i.map=a[3]),!n&&f&256&&(n=!0,i.controls=a[8],Q(()=>n=!1)),l.$set(i)},i(a){o||(L(l.$$.fragment,a),o=!0)},o(a){C(l.$$.fragment,a),o=!1},d(a){a&&(J(e),J(t)),D(l,a)}}}function Xe(s){let e,t,l,n,o,u,p,a,f,i,m,y,h,M,_,k,z,B,T;t=new ve({props:{app:"interactive"}});function G(d){s[17](d)}let j={};s[0]!==void 0&&(j.example=s[0]),i=new Se({props:j}),Z.push(()=>W(i,"example",G)),h=new Ie({props:{map:s[3]}}),h.$on("gotXml",s[13]),h.$on("loading",s[18]),h.$on("error",s[19]);let w=s[10]&&se(s),c=s[4]&&ae(s),b=s[6].metadata&&le(s);return{c(){e=S("div"),O(t.$$.fragment),l=I(),n=S("label"),o=V("Open an "),u=S("i"),u.textContent=".osm.pbf",p=V(`
      file
      `),a=S("input"),f=I(),O(i.$$.fragment),y=I(),O(h.$$.fragment),M=I(),w&&w.c(),_=I(),c&&c.c(),k=I(),b&&b.c(),R(a,"type","file"),R(e,"slot","left")},m(d,E){P(d,e,E),q(t,e,null),v(e,l),v(e,n),v(n,o),v(n,u),v(n,p),v(n,a),s[16](a),v(e,f),q(i,e,null),v(e,y),q(h,e,null),v(e,M),w&&w.m(e,null),v(e,_),c&&c.m(e,null),v(e,k),b&&b.m(e,null),z=!0,B||(T=N(a,"change",s[11]),B=!0)},p(d,E){const A={};!m&&E&1&&(m=!0,A.example=d[0],Q(()=>m=!1)),i.$set(A);const F={};E&8&&(F.map=d[3]),h.$set(F),d[10]?w?w.p(d,E):(w=se(d),w.c(),w.m(e,_)):w&&(w.d(1),w=null),d[4]?c?(c.p(d,E),E&16&&L(c,1)):(c=ae(d),c.c(),L(c,1),c.m(e,k)):c&&(ee(),C(c,1,1,()=>{c=null}),te()),d[6].metadata?b?(b.p(d,E),E&64&&L(b,1)):(b=le(d),b.c(),L(b,1),b.m(e,null)):b&&(ee(),C(b,1,1,()=>{b=null}),te())},i(d){z||(L(t.$$.fragment,d),L(i.$$.fragment,d),L(h.$$.fragment,d),L(c),L(b),z=!0)},o(d){C(t.$$.fragment,d),C(i.$$.fragment,d),C(h.$$.fragment,d),C(c),C(b),z=!1},d(d){d&&J(e),D(t),s[16](null),D(i),D(h),w&&w.d(),c&&c.d(),b&&b.d(),B=!1,T()}}}function Ze(s){let e,t;return{c(){e=new Ee(!1),t=Me(),e.a=t},m(l,n){e.m(Fe,l,n),P(l,t,n)},p:Be,d(l){l&&(J(t),e.d())}}}function Ge(s){let e,t;return e=new Ne({props:{controls:s[8]}}),{c(){O(e.$$.fragment)},m(l,n){q(e,l,n),t=!0},p(l,n){const o={};n&256&&(o.controls=l[8]),e.$set(o)},i(l){t||(L(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){D(e,l)}}}function He(s){let e,t,l,n,o;function u(a){s[14](a)}let p={draggable:!0,$$slots:{default:[Ze]},$$scope:{ctx:s}};return s[5]!==void 0&&(p.lngLat=s[5]),e=new Ae({props:p}),Z.push(()=>W(e,"lngLat",u)),e.$on("dragend",s[12]),n=new Pe({props:{data:s[6],$$slots:{default:[Ge]},$$scope:{ctx:s}}}),{c(){O(e.$$.fragment),l=I(),O(n.$$.fragment)},m(a,f){q(e,a,f),P(a,l,f),q(n,a,f),o=!0},p(a,f){const i={};f&67108864&&(i.$$scope={dirty:f,ctx:a}),!t&&f&32&&(t=!0,i.lngLat=a[5],Q(()=>t=!1)),e.$set(i);const m={};f&64&&(m.data=a[6]),f&67109120&&(m.$$scope={dirty:f,ctx:a}),n.$set(m)},i(a){o||(L(e.$$.fragment,a),L(n.$$.fragment,a),o=!0)},o(a){C(e.$$.fragment,a),C(n.$$.fragment,a),o=!1},d(a){a&&J(l),D(e,a),D(n,a)}}}function Ue(s){let e,t,l,n;function o(p){s[15](p)}let u={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[He]},$$scope:{ctx:s}};return s[3]!==void 0&&(u.map=s[3]),t=new ye({props:u}),Z.push(()=>W(t,"map",o)),{c(){e=S("div"),O(t.$$.fragment),R(e,"slot","main"),K(e,"position","relative"),K(e,"width","100%"),K(e,"height","100vh")},m(p,a){P(p,e,a),q(t,e,null),n=!0},p(p,a){const f={};a&67109216&&(f.$$scope={dirty:a,ctx:p}),!l&&a&8&&(l=!0,f.map=p[3],Q(()=>l=!1)),t.$set(f)},i(p){n||(L(t.$$.fragment,p),n=!0)},o(p){C(t.$$.fragment,p),n=!1},d(p){p&&J(e),D(t)}}}function Ke(s){let e,t,l,n;return e=new we({props:{$$slots:{main:[Ue],left:[Xe]},$$scope:{ctx:s}}}),l=new ze({props:{loading:s[7]}}),{c(){O(e.$$.fragment),t=I(),O(l.$$.fragment)},m(o,u){q(e,o,u),P(o,t,u),q(l,o,u),n=!0},p(o,[u]){const p={};u&67110783&&(p.$$scope={dirty:u,ctx:o}),e.$set(p);const a={};u&128&&(a.loading=o[7]),l.$set(a)},i(o){n||(L(e.$$.fragment,o),L(l.$$.fragment,o),n=!0)},o(o){C(e.$$.fragment,o),C(l.$$.fragment,o),n=!1},d(o){o&&J(t),D(e,o),D(l,o)}}}function We(s,e,t){Le(async()=>{await Oe(),await ke()});let l,n,o="",u={lng:0,lat:0},p={type:"FeatureCollection",features:[]},a=!1,f=1e3,i="Distance",m={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},y;async function h(g){t(0,o=""),t(7,a=!0),M(await y.files[0].arrayBuffer())}function M(g){try{t(4,n=new qe(new Uint8Array(g))),t(2,i="Distance");let r=n.getBounds();l.fitBounds([[r[0],r[1]],[r[2],r[3]]],{padding:20,animate:!1}),t(5,u.lng=(r[0]+r[2])/2,u),t(5,u.lat=(r[1]+r[3])/2,u),k()}catch(r){window.alert(`Problem importing osm.pbf file: ${r}`)}t(7,a=!1)}async function _(g){if(g!=""){t(7,a=!0);let r=await fetch(`https://assets.od2net.org/pbf_clips/${g}.osm.pbf`);M(await r.arrayBuffer())}}function k(){n&&t(6,p=JSON.parse(n.recalculate({lng:u.lng,lat:u.lat,max_requests:f,cost:i})))}function z(g,r){k()}let B="";function T(g){t(10,B="Parsing XML"),M(new TextEncoder().encode(g.detail)),t(10,B="")}function G(g){u=g,t(5,u)}function j(g){l=g,t(3,l)}function w(g){Z[g?"unshift":"push"](()=>{y=g,t(9,y)})}function c(g){o=g,t(0,o)}const b=g=>t(10,B=g.detail),d=g=>t(10,B=g.detail);function E(){f=fe(this.value),t(1,f)}function A(g){i=g,t(2,i)}function F(g){m=g,t(8,m)}return s.$$.update=()=>{s.$$.dirty&1&&_(o),s.$$.dirty&6&&z()},[o,f,i,l,n,u,p,a,m,y,B,h,k,T,G,j,w,c,b,d,E,A,F]}class Qe extends oe{constructor(e){super(),re(this,e,We,Ke,ie,{})}}new Qe({target:document.getElementById("app")});
