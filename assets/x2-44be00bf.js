import{S as ie,i as re,s as fe,G as ce,e as S,h as T,z as W,l as R,I as x,q as N,J as pe,K as de,N as me,O as ge,t as y,b as k,v as J,w as _e,Q as be,R as he,T as $,U as ee,m as we,L as Le,c as q,f as O,a as D,d as P,o as ye,H as ve,x as H,y as Q,g as Y,n as v,A as V,r as te,u as ne,M as Ce,_ as ke,V as ue,W as Me,j as se,D as Be,E as Ee,X as ze}from"./Legend-07540826.js";import{L as Se,C as Ie,O as Oe,_ as qe,J as De,a as Pe,G as Re}from"./OverpassSelector-c6601889.js";import{S as Je,L as Ne}from"./SidebarControls-66544d53.js";function Te(s){let e,t,l,n,o,f,c;const a=s[17].default,r=ce(a,s,s[16],null);return{c(){e=S("div"),r&&r.c(),T(e,"tabindex",t=s[1]?0:void 0),T(e,"role",l=s[1]?"button":void 0),W(e,"z-index",s[2])},m(i,m){R(i,e,m),r&&r.m(e,null),o=!0,f||(c=[x(s[6].call(null,e)),x(n=je.call(null,e,s[0])),N(e,"click",s[18]),N(e,"dblclick",s[19]),N(e,"contextmenu",s[20]),N(e,"mouseenter",s[21]),N(e,"mouseleave",s[22]),N(e,"mousemove",s[23]),N(e,"keydown",s[7])],f=!0)},p(i,[m]){r&&r.p&&(!o||m&65536)&&pe(r,a,i,i[16],o?me(a,i[16],m,null):de(i[16]),null),(!o||m&2&&t!==(t=i[1]?0:void 0))&&T(e,"tabindex",t),(!o||m&2&&l!==(l=i[1]?"button":void 0))&&T(e,"role",l),n&&ge(n.update)&&m&1&&n.update.call(null,i[0]),m&4&&W(e,"z-index",i[2])},i(i){o||(y(r,i),o=!0)},o(i){k(r,i),o=!1},d(i){i&&J(e),r&&r.d(i),f=!1,_e(c)}}}function je(s,e){const t=s.className;function l(n){n?s.className=`${t} ${n}`:s.className=t}return l(e),{update:l}}function Ae(s,e,t){let l,n,o,{$$slots:f={},$$scope:c}=e,{lngLat:a}=e,{class:r=void 0}=e,{interactive:i=!0}=e,{asButton:m=!1}=e,{draggable:C=!1}=e,{feature:h=null}=e,{offset:B=void 0}=e,{zIndex:_=void 0}=e,{rotation:w=0}=e;const I=be(),{map:z,layerEvent:j,self:A}=he();$(s,z,u=>t(25,o=u)),$(s,j,u=>t(24,l=u)),$(s,A,u=>t(15,n=u));function F(u){ee(A,n=new we.Marker({element:u,rotation:w,draggable:C,offset:B}).setLngLat(a).addTo(o),n);const G=()=>p("dragstart"),U=()=>{L(),p("drag")},K=()=>{L(),p("dragend")};return C&&(n.on("dragstart",G),n.on("drag",U),n.on("dragend",K)),{destroy(){C&&(n==null||n.off("dragstart",G),n==null||n.off("drag",U),n==null||n.off("dragend",K)),n==null||n.remove()}}}function L(){let u=n==null?void 0:n.getLngLat();u&&(Array.isArray(a)?t(9,a=[u.lng,u.lat]):a&&"lon"in a?t(9,a={lon:u.lng,lat:u.lat}):t(9,a=u))}function b(u){u.key===" "&&(u.preventDefault(),u.stopPropagation(),p("click"))}function p(u){if(!i)return;let G=n==null?void 0:n.getLngLat();if(!G)return;const U=[G.lng,G.lat];let K={map:o,marker:n,lngLat:U,features:[{type:"Feature",properties:(h==null?void 0:h.properties)??{},geometry:{type:"Point",coordinates:U}}]};ee(j,l={...K,layerType:"marker",type:u},l),I(u,K)}const d=()=>p("click"),E=()=>p("dblclick"),X=()=>p("contextmenu"),Z=u=>{p("mouseenter")},g=()=>{p("mouseleave")},M=()=>p("mousemove");return s.$$set=u=>{"lngLat"in u&&t(9,a=u.lngLat),"class"in u&&t(0,r=u.class),"interactive"in u&&t(10,i=u.interactive),"asButton"in u&&t(1,m=u.asButton),"draggable"in u&&t(11,C=u.draggable),"feature"in u&&t(12,h=u.feature),"offset"in u&&t(13,B=u.offset),"zIndex"in u&&t(2,_=u.zIndex),"rotation"in u&&t(14,w=u.rotation),"$$scope"in u&&t(16,c=u.$$scope)},s.$$.update=()=>{s.$$.dirty&33280&&(n==null||n.setLngLat(a)),s.$$.dirty&40960&&(n==null||n.setOffset(B??[0,0])),s.$$.dirty&49152&&(n==null||n.setRotation(w))},[r,m,_,z,j,A,F,b,p,a,i,C,h,B,w,n,c,f,d,E,X,Z,g,M]}class Fe extends ie{constructor(e){super(),re(this,e,Ae,Te,fe,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2,rotation:14})}}const Xe=`<svg width="40" height="50" viewBox="0 0 40 50" xmlns="http://www.w3.org/2000/svg">
    <defs/>
    <path id="path2" fill="none" stroke="none" visibility="hidden" d="M 1.0169492 25.59322 L 25.016949 25.59322 L 25.016949 49.59322 L 1.0169492 49.59322 Z"/>
    <path id="path4" fill="#000000" stroke="none" d="M 19.198305 2.6101693 C 10.336661 2.6101693 3.1694916 9.7773384 3.1694916 18.638983 C 3.1694916 30.660593 19.198305 48.406779 19.198305 48.406779 C 19.198305 48.406779 35.227118 30.660593 35.227118 18.638983 C 35.227118 9.7773384 28.059949 2.6101693 19.198305 2.6101693 Z M 19.198305 24.363559 C 16.038339 24.363559 13.473728 21.798949 13.473728 18.638983 C 13.473728 15.479016 16.038339 12.914406 19.198305 12.914406 C 22.358271 12.914406 24.922881 15.479016 24.922881 18.638983 C 24.922881 21.798949 22.358271 24.363559 19.198305 24.363559 Z"/>
</svg>
`;function ae(s){let e,t;return{c(){e=S("p"),t=Y(s[10])},m(l,n){R(l,e,n),v(e,t)},p(l,n){n&1024&&Me(t,l[10])},d(l){l&&J(e)}}}function le(s){let e,t,l,n,o,f,c,a,r,i,m,C;function h(_){s[21](_)}let B={};return s[2]!==void 0&&(B.cost=s[2]),a=new Pe({props:B}),H.push(()=>Q(a,"cost",h)),{c(){e=S("div"),t=S("label"),l=Y(`Max requests (limit for faster updates):
          `),n=S("br"),o=O(),f=S("input"),c=O(),q(a.$$.fragment),T(f,"type","number"),T(f,"min",1)},m(_,w){R(_,e,w),v(e,t),v(t,l),v(t,n),v(t,o),v(t,f),se(f,s[1]),R(_,c,w),D(a,_,w),i=!0,m||(C=N(f,"input",s[20]),m=!0)},p(_,w){w&2&&ue(f.value)!==_[1]&&se(f,_[1]);const I={};!r&&w&4&&(r=!0,I.cost=_[2],V(()=>r=!1)),a.$set(I)},i(_){i||(y(a.$$.fragment,_),i=!0)},o(_){k(a.$$.fragment,_),i=!1},d(_){_&&(J(e),J(c)),P(a,_),m=!1,C()}}}function oe(s){let e,t,l,n,o;function f(a){s[22](a)}let c={outputMetadata:s[6].metadata,map:s[3]};return s[8]!==void 0&&(c.controls=s[8]),l=new Je({props:c}),H.push(()=>Q(l,"controls",f)),{c(){e=S("hr"),t=O(),q(l.$$.fragment)},m(a,r){R(a,e,r),R(a,t,r),D(l,a,r),o=!0},p(a,r){const i={};r&64&&(i.outputMetadata=a[6].metadata),r&8&&(i.map=a[3]),!n&&r&256&&(n=!0,i.controls=a[8],V(()=>n=!1)),l.$set(i)},i(a){o||(y(l.$$.fragment,a),o=!0)},o(a){k(l.$$.fragment,a),o=!1},d(a){a&&(J(e),J(t)),P(l,a)}}}function Ze(s){let e,t,l,n,o,f,c,a,r,i,m,C,h,B,_,w,I,z,j;t=new ve({props:{app:"interactive"}});function A(d){s[17](d)}let F={};s[0]!==void 0&&(F.example=s[0]),i=new Ie({props:F}),H.push(()=>Q(i,"example",A)),h=new Oe({props:{map:s[3]}}),h.$on("gotXml",s[13]),h.$on("loading",s[18]),h.$on("error",s[19]);let L=s[10]&&ae(s),b=s[4]&&le(s),p=s[6].metadata&&oe(s);return{c(){e=S("div"),q(t.$$.fragment),l=O(),n=S("label"),o=Y("Open an "),f=S("i"),f.textContent=".osm.pbf",c=Y(`
      file
      `),a=S("input"),r=O(),q(i.$$.fragment),C=O(),q(h.$$.fragment),B=O(),L&&L.c(),_=O(),b&&b.c(),w=O(),p&&p.c(),T(a,"type","file"),T(e,"slot","left")},m(d,E){R(d,e,E),D(t,e,null),v(e,l),v(e,n),v(n,o),v(n,f),v(n,c),v(n,a),s[16](a),v(e,r),D(i,e,null),v(e,C),D(h,e,null),v(e,B),L&&L.m(e,null),v(e,_),b&&b.m(e,null),v(e,w),p&&p.m(e,null),I=!0,z||(j=N(a,"change",s[11]),z=!0)},p(d,E){const X={};!m&&E&1&&(m=!0,X.example=d[0],V(()=>m=!1)),i.$set(X);const Z={};E&8&&(Z.map=d[3]),h.$set(Z),d[10]?L?L.p(d,E):(L=ae(d),L.c(),L.m(e,_)):L&&(L.d(1),L=null),d[4]?b?(b.p(d,E),E&16&&y(b,1)):(b=le(d),b.c(),y(b,1),b.m(e,w)):b&&(te(),k(b,1,1,()=>{b=null}),ne()),d[6].metadata?p?(p.p(d,E),E&64&&y(p,1)):(p=oe(d),p.c(),y(p,1),p.m(e,null)):p&&(te(),k(p,1,1,()=>{p=null}),ne())},i(d){I||(y(t.$$.fragment,d),y(i.$$.fragment,d),y(h.$$.fragment,d),y(b),y(p),I=!0)},o(d){k(t.$$.fragment,d),k(i.$$.fragment,d),k(h.$$.fragment,d),k(b),k(p),I=!1},d(d){d&&J(e),P(t),s[16](null),P(i),P(h),L&&L.d(),b&&b.d(),p&&p.d(),z=!1,j()}}}function Ge(s){let e,t;return{c(){e=new ze(!1),t=Be(),e.a=t},m(l,n){e.m(Xe,l,n),R(l,t,n)},p:Ee,d(l){l&&(J(t),e.d())}}}function He(s){let e,t;return e=new Ne({props:{controls:s[8]}}),{c(){q(e.$$.fragment)},m(l,n){D(e,l,n),t=!0},p(l,n){const o={};n&256&&(o.controls=l[8]),e.$set(o)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){k(e.$$.fragment,l),t=!1},d(l){P(e,l)}}}function Ue(s){let e,t,l,n,o;function f(a){s[14](a)}let c={draggable:!0,$$slots:{default:[Ge]},$$scope:{ctx:s}};return s[5]!==void 0&&(c.lngLat=s[5]),e=new Fe({props:c}),H.push(()=>Q(e,"lngLat",f)),e.$on("dragend",s[12]),n=new Re({props:{data:s[6],$$slots:{default:[He]},$$scope:{ctx:s}}}),{c(){q(e.$$.fragment),l=O(),q(n.$$.fragment)},m(a,r){D(e,a,r),R(a,l,r),D(n,a,r),o=!0},p(a,r){const i={};r&67108864&&(i.$$scope={dirty:r,ctx:a}),!t&&r&32&&(t=!0,i.lngLat=a[5],V(()=>t=!1)),e.$set(i);const m={};r&64&&(m.data=a[6]),r&67109120&&(m.$$scope={dirty:r,ctx:a}),n.$set(m)},i(a){o||(y(e.$$.fragment,a),y(n.$$.fragment,a),o=!0)},o(a){k(e.$$.fragment,a),k(n.$$.fragment,a),o=!1},d(a){a&&J(l),P(e,a),P(n,a)}}}function Ke(s){let e,t,l,n;function o(c){s[15](c)}let f={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Ue]},$$scope:{ctx:s}};return s[3]!==void 0&&(f.map=s[3]),t=new Ce({props:f}),H.push(()=>Q(t,"map",o)),{c(){e=S("div"),q(t.$$.fragment),T(e,"slot","main"),W(e,"position","relative"),W(e,"width","100%"),W(e,"height","100vh")},m(c,a){R(c,e,a),D(t,e,null),n=!0},p(c,a){const r={};a&67109216&&(r.$$scope={dirty:a,ctx:c}),!l&&a&8&&(l=!0,r.map=c[3],V(()=>l=!1)),t.$set(r)},i(c){n||(y(t.$$.fragment,c),n=!0)},o(c){k(t.$$.fragment,c),n=!1},d(c){c&&J(e),P(t)}}}function We(s){let e,t,l,n;return e=new Le({props:{$$slots:{main:[Ke],left:[Ze]},$$scope:{ctx:s}}}),l=new Se({props:{loading:s[7]}}),{c(){q(e.$$.fragment),t=O(),q(l.$$.fragment)},m(o,f){D(e,o,f),R(o,t,f),D(l,o,f),n=!0},p(o,[f]){const c={};f&67110783&&(c.$$scope={dirty:f,ctx:o}),e.$set(c);const a={};f&128&&(a.loading=o[7]),l.$set(a)},i(o){n||(y(e.$$.fragment,o),y(l.$$.fragment,o),n=!0)},o(o){k(e.$$.fragment,o),k(l.$$.fragment,o),n=!1},d(o){o&&J(t),P(e,o),P(l,o)}}}function Qe(s,e,t){ye(async()=>{await qe(),await ke()});let l,n,o="",f={lng:0,lat:0},c={type:"FeatureCollection",features:[]},a=!1,r=1e3,i="Distance",m={maxCount:1e3,originRadius:3,destinationRadius:3,streetviewOn:!1},C;async function h(g){t(0,o=""),t(7,a=!0),B(await C.files[0].arrayBuffer())}function B(g){try{t(4,n=new De(new Uint8Array(g))),t(2,i="Distance");let M=n.getBounds();l.fitBounds([[M[0],M[1]],[M[2],M[3]]],{padding:20,animate:!1}),t(5,f.lng=(M[0]+M[2])/2,f),t(5,f.lat=(M[1]+M[3])/2,f),w()}catch(M){window.alert(`Problem importing osm.pbf file: ${M}`)}t(7,a=!1)}async function _(g){if(g!=""){t(7,a=!0);let M=await fetch(`https://assets.od2net.org/pbf_clips/${g}.osm.pbf`);B(await M.arrayBuffer())}}function w(){n&&t(6,c=JSON.parse(n.recalculate({lng:f.lng,lat:f.lat,max_requests:r,cost:i})))}function I(g,M){w()}let z="";function j(g){t(10,z="Parsing XML"),B(new TextEncoder().encode(g.detail)),t(10,z="")}function A(g){f=g,t(5,f)}function F(g){l=g,t(3,l)}function L(g){H[g?"unshift":"push"](()=>{C=g,t(9,C)})}function b(g){o=g,t(0,o)}const p=g=>t(10,z=g.detail),d=g=>t(10,z=g.detail);function E(){r=ue(this.value),t(1,r)}function X(g){i=g,t(2,i)}function Z(g){m=g,t(8,m)}return s.$$.update=()=>{s.$$.dirty&1&&_(o),s.$$.dirty&6&&I()},[o,r,i,l,n,f,c,a,m,C,z,h,w,j,A,F,L,b,p,d,E,X,Z]}class Ve extends ie{constructor(e){super(),re(this,e,Qe,We,fe,{})}}new Ve({target:document.getElementById("app")});
