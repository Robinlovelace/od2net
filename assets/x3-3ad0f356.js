import{S as le,i as ae,s as se,V as J,e as m,f as N,z as v,l as y,E as z,v as S,ad as X,g as A,n as p,X as ie,L as oe,c as L,a as C,t as h,b,d as T,o as ue,H as fe,h as G,j as R,k as ce,p as Z,q as K,r as pe,u as _e,w as me,M as de,x as re,y as ge,A as $e,_ as he,a3 as be,ae as Q,C as we,af as D,ac as ke,a7 as B,a6 as ve,a4 as H,a8 as ye,a9 as Se}from"./Legend-7948e5f4.js";import{_ as Le,J as Ce,G as Te}from"./@vite-plugin-wasm-pack@wasm-od2net-acbe675d.js";function Y(s,e,n){const t=s.slice();return t[2]=e[n],t}function x(s,e,n){const t=s.slice();return t[5]=e[n],t}function ee(s){let e,n;return{c(){e=m("span"),n=A(`Â 
    `),v(e,"background",s[5]),v(e,"width","100%"),v(e,"border","1px solid black")},m(t,l){y(t,e,l),p(e,n)},p(t,l){l&1&&v(e,"background",t[5])},d(t){t&&S(e)}}}function te(s){let e,n=s[2]+"",t;return{c(){e=m("span"),t=A(n)},m(l,a){y(l,e,a),p(e,t)},p(l,a){a&2&&n!==(n=l[2]+"")&&ie(t,n)},d(l){l&&S(e)}}}function je(s){let e,n,t,l=J(s[0]),a=[];for(let i=0;i<l.length;i+=1)a[i]=ee(x(s,l,i));let u=J(s[1]),o=[];for(let i=0;i<u.length;i+=1)o[i]=te(Y(s,u,i));return{c(){e=m("div");for(let i=0;i<a.length;i+=1)a[i].c();n=N(),t=m("div");for(let i=0;i<o.length;i+=1)o[i].c();v(e,"display","flex"),v(t,"display","flex"),v(t,"justify-content","space-between")},m(i,c){y(i,e,c);for(let r=0;r<a.length;r+=1)a[r]&&a[r].m(e,null);y(i,n,c),y(i,t,c);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(t,null)},p(i,[c]){if(c&1){l=J(i[0]);let r;for(r=0;r<l.length;r+=1){const w=x(i,l,r);a[r]?a[r].p(w,c):(a[r]=ee(w),a[r].c(),a[r].m(e,null))}for(;r<a.length;r+=1)a[r].d(1);a.length=l.length}if(c&2){u=J(i[1]);let r;for(r=0;r<u.length;r+=1){const w=Y(i,u,r);o[r]?o[r].p(w,c):(o[r]=te(w),o[r].c(),o[r].m(t,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=u.length}},i:z,o:z,d(i){i&&(S(e),S(n),S(t)),X(a,i),X(o,i)}}}function qe(s,e,n){let{colorScale:t}=e,{limits:l}=e;return s.$$set=a=>{"colorScale"in a&&n(0,t=a.colorScale),"limits"in a&&n(1,l=a.limits)},[t,l]}class Oe extends le{constructor(e){super(),ae(this,e,qe,je,se,{colorScale:0,limits:1})}}function Me(s){let e,n;return e=new Oe({props:{colorScale:D,limits:F(s[2])}}),{c(){L(e.$$.fragment)},m(t,l){C(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.limits=F(t[2])),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Ne(s){let e,n,t,l;return e=new ke({props:{rows:[["LTS 1 - suitable for children",B.lts1],["LTS 2 - low stress",B.lts2],["LTS 3 - medium stress",B.lts3],["LTS 4 - high stress",B.lts4]]}}),{c(){L(e.$$.fragment),n=N(),t=m("p"),t.innerHTML='Note: LTS model from <a href="https://github.com/BikeOttawa/stressmodel/blob/master/stressmodel.js" target="_blank">BikeOttawa</a>'},m(a,u){C(e,a,u),y(a,n,u),y(a,t,u),l=!0},p:z,i(a){l||(h(e.$$.fragment,a),l=!0)},o(a){b(e.$$.fragment,a),l=!1},d(a){a&&(S(n),S(t)),T(e,a)}}}function Ee(s){let e,n,t,l,a,u,o,i,c,r,w,g,j,f,k,O,d,$,E,I,U;n=new fe({props:{app:"costs"}});const V=[Ne,Me],q=[];function W(_,M){return _[2]=="lts"?0:1}return d=W(s),$=q[d]=V[d](s),{c(){e=m("div"),L(n.$$.fragment),t=N(),l=m("label"),a=A("Open a "),u=m("i"),u.textContent=".bin",o=A(" network file or an "),i=m("i"),i.textContent=".osm.pbf",c=N(),r=m("input"),w=N(),g=m("select"),j=m("option"),j.textContent="LTS",f=m("option"),f.textContent="Edge cost (relative to length)",k=m("option"),k.textContent="Nearby amenities",O=N(),$.c(),G(r,"type","file"),j.__value="lts",R(j,j.__value),f.__value="cost",R(f,f.__value),k.__value="nearby_amenities",R(k,k.__value),s[2]===void 0&&ce(()=>s[9].call(g)),G(e,"slot","left")},m(_,M){y(_,e,M),C(n,e,null),p(e,t),p(e,l),p(l,a),p(l,u),p(l,o),p(l,i),p(l,c),p(l,r),s[8](r),p(e,w),p(e,g),p(g,j),p(g,f),p(g,k),Z(g,s[2],!0),p(e,O),q[d].m(e,null),E=!0,I||(U=[K(r,"change",s[4]),K(g,"change",s[9])],I=!0)},p(_,M){M&4&&Z(g,_[2]);let P=d;d=W(_),d===P?q[d].p(_,M):(pe(),b(q[P],1,1,()=>{q[P]=null}),_e(),$=q[d],$?$.p(_,M):($=q[d]=V[d](_),$.c()),h($,1),$.m(e,null))},i(_){E||(h(n.$$.fragment,_),h($),E=!0)},o(_){b(n.$$.fragment,_),b($),E=!1},d(_){_&&S(e),T(n),s[8](null),q[d].d(),I=!1,me(U)}}}function Je(s){let e,n;return e=new Se({props:{properties:s[11][0].properties}}),{c(){L(e.$$.fragment)},m(t,l){C(e,t,l),n=!0},p(t,l){const a={};l&2048&&(a.properties=t[11][0].properties),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Be(s){let e,n;return e=new ye({props:{openOn:"hover",$$slots:{default:[Je,({features:t})=>({11:t}),({features:t})=>t?2048:0]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},m(t,l){C(e,t,l),n=!0},p(t,l){const a={};l&6144&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function He(s){let e,n;return e=new ve({props:{manageHoverState:!0,hoverCursor:"pointer",paint:{"line-width":5,"line-color":s[5](s[2]),"line-opacity":s[2]=="nearby_amenities"?["case",["==",0,["get","nearby_amenities"]],0,H(1,.5)]:H(1,.5)},beforeId:"Road labels",$$slots:{default:[Be]},$$scope:{ctx:s}}}),e.$on("click",s[6]),{c(){L(e.$$.fragment)},m(t,l){C(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.paint={"line-width":5,"line-color":t[5](t[2]),"line-opacity":t[2]=="nearby_amenities"?["case",["==",0,["get","nearby_amenities"]],0,H(1,.5)]:H(1,.5)}),l&4096&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Ae(s){let e,n;return e=new Te({props:{data:s[1],$$slots:{default:[He]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},m(t,l){C(e,t,l),n=!0},p(t,l){const a={};l&2&&(a.data=t[1]),l&4100&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Fe(s){let e,n,t,l;function a(o){s[7](o)}let u={style:"https://api.maptiler.com/maps/dataviz/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,hash:!0,$$slots:{default:[Ae]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.map=s[0]),n=new de({props:u}),re.push(()=>ge(n,"map",a)),{c(){e=m("div"),L(n.$$.fragment),G(e,"slot","main"),v(e,"position","relative"),v(e,"width","100%"),v(e,"height","100vh")},m(o,i){y(o,e,i),C(n,e,null),l=!0},p(o,i){const c={};i&4102&&(c.$$scope={dirty:i,ctx:o}),!t&&i&1&&(t=!0,c.map=o[0],$e(()=>t=!1)),n.$set(c)},i(o){l||(h(n.$$.fragment,o),l=!0)},o(o){b(n.$$.fragment,o),l=!1},d(o){o&&S(e),T(n)}}}function Ie(s){let e,n;return e=new oe({props:{$$slots:{main:[Fe],left:[Ee]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},m(t,l){C(e,t,l),n=!0},p(t,[l]){const a={};l&4111&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Pe(s){let e=s.properties.way;window.open(`http://openstreetmap.org/way/${e}`,"_blank")}function F(s){if(s=="lts")return null;if(s=="cost")return ne(1,30);if(s=="nearby_amenities")return ne(0,20)}function ne(s,e){let n=[],t=(e-s)/5;for(let l=0;l<6;l++)n.push(s+l*t);return n}function Re(s,e,n){ue(async()=>{await Le(),await he()});let t,l,a={type:"FeatureCollection",features:[]},u="lts",o;async function i(f){try{let k=await o.files[0].arrayBuffer();l=new Ce(new Uint8Array(k));let O=l.getBounds();t.fitBounds([[O[0],O[1]],[O[2],O[3]]],{padding:20,animate:!1}),n(1,a=JSON.parse(l.debugNetwork()))}catch(k){window.alert(`Problem loading network file: ${k}`)}}function c(f){if(f=="lts")return be;if(f=="cost")return Q(["/",["get","cost"],["get","length"]],F(f),D);if(f=="nearby_amenities")return Q(["get","nearby_amenities"],F(f),D)}const r=f=>Pe(f.detail.features[0]);function w(f){t=f,n(0,t)}function g(f){re[f?"unshift":"push"](()=>{o=f,n(3,o)})}function j(){u=we(this),n(2,u)}return[t,a,u,o,i,c,r,w,g,j]}class ze extends le{constructor(e){super(),ae(this,e,Re,Ie,se,{})}}new ze({target:document.getElementById("app")});
